{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "ADF-PLTDEV-SRPT01"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Adhoc_Files_ADLS_to_DB_copy1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set variable2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,4)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(or(or(equals(variables('filename_trim_value'),'Expo'),equals(variables('filename_trim_value'),'Excl')), equals(variables('filename_trim_value'),'Pack')), equals(variables('filename_trim_value'), 'TU M'))",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Switch_File_Type_copy1",
									"type": "Switch",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@variables('filename_trim_value')",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "Expo",
												"activities": [
													{
														"name": "PF_Export_Job_Name_copy1",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_Export_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Export",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Export_Job_Name_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Export_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Export",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Export",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Export').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.exec_status",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Reuse FTP Adhoc Export",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Export",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "Pl_Reuse_FTP_Adhoc_Files",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Export').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Export').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"directory_ftp": {
																	"value": "@pipeline().parameters.directory_ftp",
																	"type": "Expression"
																},
																"sheet": {
																	"value": "@pipeline().parameters.sheet_export",
																	"type": "Expression"
																},
																"range": {
																	"value": "@pipeline().parameters.range_export",
																	"type": "Expression"
																},
																"filesystem_adls": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_adhoc_files": {
																	"value": "@pipeline().parameters.directory_export",
																	"type": "Expression"
																},
																"file_name_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"table_name_adhoc": {
																	"value": "@pipeline().parameters.table_export",
																	"type": "Expression"
																},
																"schema_ftp": {
																	"value": "@pipeline().parameters.schema_ftp",
																	"type": "Expression"
																},
																"json_mapping": {
																	"value": "@pipeline().parameters.mapping_export",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table_job_run_log": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"table_job_file_log": {
																	"value": "@pipeline().parameters.table_job_file_log",
																	"type": "Expression"
																},
																"table_job_control": {
																	"value": "@pipeline().parameters.table_job_control",
																	"type": "Expression"
																},
																"stored_procedure": {
																	"value": "@pipeline().parameters.sp_export",
																	"type": "Expression"
																},
																"filename_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"file_extension": {
																	"value": "@pipeline().parameters.file_extension",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Export",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Staging to Curated Export",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Tran_Adhoc_Files_Target_Table_to_Curated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_export_rnd",
																	"type": "Expression"
																},
																"container": {
																	"value": "@pipeline().parameters.container_export",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('lookup1_copy1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_name_exclusion_value": {
																	"value": "@pipeline().parameters.job_name_export",
																	"type": "Expression"
																},
																"mapping_dynamic": {
																	"value": "@pipeline().parameters.mapping_export_stg",
																	"type": "Expression"
																},
																"file_name_query": {
																	"value": "@pipeline().parameters.export_file_name_query",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Failure Alert Export",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Export",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Staging to Curated Export",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Export').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "Excl",
												"activities": [
													{
														"name": "PF_Export_Job_Name_Exclusion",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_exclusion')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Exclusion",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Export_Job_Name_Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Export_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Exclusion",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Exclusion').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.exec_status",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Staging to Curated Exclusion",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Tran_Adhoc_Files_Target_Table_to_Curated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_exclusion_rnd",
																	"type": "Expression"
																},
																"container": {
																	"value": "@pipeline().parameters.container_exclusion",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('lookup1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_name_exclusion_value": {
																	"value": "@pipeline().parameters.job_name_exclusion",
																	"type": "Expression"
																},
																"mapping_dynamic": {
																	"value": "@pipeline().parameters.mapping_exclusion_stg",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Reuse FTP Exclusion",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "Pl_Reuse_FTP_Adhoc_Files",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Exclusion').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Exclusion').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"directory_ftp": {
																	"value": "@pipeline().parameters.directory_ftp",
																	"type": "Expression"
																},
																"sheet": {
																	"value": "@pipeline().parameters.sheet_exclusion",
																	"type": "Expression"
																},
																"range": {
																	"value": "@pipeline().parameters.range_exclusion",
																	"type": "Expression"
																},
																"filesystem_adls": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_adhoc_files": {
																	"value": "@pipeline().parameters.directory_exclusion",
																	"type": "Expression"
																},
																"file_name_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"table_name_adhoc": {
																	"value": "@pipeline().parameters.table_exclusion",
																	"type": "Expression"
																},
																"schema_ftp": {
																	"value": "@pipeline().parameters.schema_ftp",
																	"type": "Expression"
																},
																"json_mapping": {
																	"value": "@pipeline().parameters.mapping_exclusion",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table_job_run_log": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"table_job_file_log": {
																	"value": "@pipeline().parameters.table_job_file_log",
																	"type": "Expression"
																},
																"table_job_control": {
																	"value": "@pipeline().parameters.table_job_control",
																	"type": "Expression"
																},
																"stored_procedure": {
																	"value": "@pipeline().parameters.sp_exclusion",
																	"type": "Expression"
																},
																"filename_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"file_extension": {
																	"value": "@pipeline().parameters.file_extension",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute  Fail Alert Exclusion",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Exclusion",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Staging to Curated Exclusion",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Exclusion').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "Pack",
												"activities": [
													{
														"name": "LKP_Job_Key_Substitution",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Export_Job_Name_Substitution",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_substitution'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Substitution",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Substitution",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Substitution').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.exec_status",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "PF_Export_Job_Name_Substitution",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_substitution')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "Execute Reuse FTP Adhoc Subst",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Substitution",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "Pl_Reuse_FTP_Adhoc_Files",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Substitution').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Substitution').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"directory_ftp": {
																	"value": "@pipeline().parameters.directory_ftp",
																	"type": "Expression"
																},
																"sheet": {
																	"value": "@pipeline().parameters.sheet_substitutions",
																	"type": "Expression"
																},
																"range": {
																	"value": "@pipeline().parameters.range_substitution",
																	"type": "Expression"
																},
																"filesystem_adls": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_adhoc_files": {
																	"value": "@pipeline().parameters.directory_substitution",
																	"type": "Expression"
																},
																"file_name_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"table_name_adhoc": {
																	"value": "@pipeline().parameters.table_substitution",
																	"type": "Expression"
																},
																"schema_ftp": {
																	"value": "@pipeline().parameters.schema_ftp",
																	"type": "Expression"
																},
																"json_mapping": {
																	"value": "@pipeline().parameters.mapping_substitution",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table_job_run_log": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"table_job_file_log": {
																	"value": "@pipeline().parameters.table_job_file_log",
																	"type": "Expression"
																},
																"table_job_control": {
																	"value": "@pipeline().parameters.table_job_control",
																	"type": "Expression"
																},
																"stored_procedure": {
																	"value": "@pipeline().parameters.sp_substitutiton",
																	"type": "Expression"
																},
																"filename_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"file_extension": {
																	"value": "@pipeline().parameters.file_extension",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1_file_key",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Subst",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Staging to Curated Subst",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1_file_key",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Tran_Adhoc_Files_Target_Table_to_Curated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_substitution_rnd",
																	"type": "Expression"
																},
																"container": {
																	"value": "@pipeline().parameters.container_export",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('Lookup1_File_key').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_name_exclusion_value": {
																	"value": "@pipeline().parameters.job_name_substitution",
																	"type": "Expression"
																},
																"mapping_dynamic": {
																	"value": "@pipeline().parameters.mapping_subst_stg",
																	"type": "Expression"
																},
																"file_name_query": {
																	"value": "@pipeline().parameters.susbst_file_name_query",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Failure Alert Subst",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Subst",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Staging to Curated Subst",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Substitution').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "TU M",
												"activities": [
													{
														"name": "Copyfrom_FTP_to_Raw_Manual_Subs",
														"type": "Copy",
														"dependsOn": [],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "ExcelSource",
																"storeSettings": {
																	"type": "FtpReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false,
																	"useBinaryTransfer": true
																}
															},
															"sink": {
																"type": "DelimitedTextSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "DelimitedTextWriteSettings",
																	"quoteAllText": true,
																	"fileExtension": {
																		"value": "@pipeline().parameters.file_extension",
																		"type": "Expression"
																	}
																}
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_FTP_All_Files",
																"type": "DatasetReference",
																"parameters": {
																	"directory": {
																		"value": "@pipeline().parameters.directory_ftp",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	},
																	"sheet_name": {
																		"value": "@pipeline().parameters.sheet_manual_substitution",
																		"type": "Expression"
																	},
																	"range": {
																		"value": "@pipeline().parameters.range_manual_substitution",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_ADLS_PLM_EBOM_copy2",
																"type": "DatasetReference",
																"parameters": {
																	"filesystem": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_substitution",
																		"type": "Expression"
																	},
																	"filename": "@concat(variables('container'),'.xlsx')"
																}
															}
														]
													},
													{
														"name": "Copy_from_raw_to_Temp_table_manua_Subst",
														"type": "Copy",
														"dependsOn": [
															{
																"activity": "Copyfrom_FTP_to_Raw_Manual_Subs",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "DelimitedTextSource",
																"additionalColumns": [
																	{
																		"name": "substitution_file_name",
																		"value": {
																			"value": "@pipeline().parameters.file_name",
																			"type": "Expression"
																		}
																	}
																],
																"storeSettings": {
																	"type": "AzureBlobStorageReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false
																},
																"formatSettings": {
																	"type": "DelimitedTextReadSettings"
																}
															},
															"sink": {
																"type": "AzureSqlSink",
																"tableOption": "autoCreate"
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_ABLB_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_substitution",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_SQL_FTP_Files",
																"type": "DatasetReference",
																"parameters": {
																	"table": {
																		"value": "@pipeline().parameters.table_manual_substitution",
																		"type": "Expression"
																	},
																	"schema": {
																		"value": "@pipeline().parameters.schema_ftp",
																		"type": "Expression"
																	}
																}
															}
														]
													}
												]
											}
										],
										"defaultActivities": [
											{
												"name": "Set variable2_copy1",
												"type": "SetVariable",
												"dependsOn": [],
												"userProperties": [],
												"typeProperties": {
													"variableName": "df_name",
													"value": {
														"value": "@pipeline().DataFactory",
														"type": "Expression"
													}
												}
											}
										]
									}
								}
							]
						}
					},
					{
						"name": "Set variable2",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "container",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,indexof(pipeline().parameters.file_name,'.'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting"
					},
					"directory_export": {
						"type": "string",
						"defaultValue": "Raw/RnD/Adhoc_Files/Export"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"schema": {
						"type": "string",
						"defaultValue": "etl"
					},
					"file_size": {
						"type": "string"
					},
					"all_xlsx_files": {
						"type": "string",
						"defaultValue": "*.xlsx"
					},
					"directory_ftp": {
						"type": "string",
						"defaultValue": "Sustainability Reporting Manual Update Files"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".xlsx"
					},
					"schema_ftp": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_export": {
						"type": "string",
						"defaultValue": "lnd_international_export"
					},
					"table_exclusion": {
						"type": "string",
						"defaultValue": "lnd_material_exclusion"
					},
					"table_substitution": {
						"type": "string",
						"defaultValue": "lnd_material_substitution"
					},
					"sheet_export": {
						"type": "string",
						"defaultValue": "Summary"
					},
					"sheet_exclusion": {
						"type": "string",
						"defaultValue": "WIP"
					},
					"sheet_substitutions": {
						"type": "string",
						"defaultValue": "Substitutions"
					},
					"range_export": {
						"type": "string",
						"defaultValue": "A1:I36"
					},
					"range_exclusion": {
						"type": "string",
						"defaultValue": "A2:F42"
					},
					"range_substitution": {
						"type": "string",
						"defaultValue": "A3:G46"
					},
					"directory_exclusion": {
						"type": "string",
						"defaultValue": "Raw/RnD/Adhoc_Files/Exclusion"
					},
					"directory_substitution": {
						"type": "string",
						"defaultValue": "Raw/RnD/Adhoc_Files/Substitution"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In Progress"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"sheet_manual_substitution": {
						"type": "string",
						"defaultValue": "TU's"
					},
					"range_manual_substitution": {
						"type": "string",
						"defaultValue": "E1:Q4"
					},
					"table_manual_substitution": {
						"type": "string",
						"defaultValue": "lnd_manual_substituion"
					},
					"table_exclusion_rnd": {
						"type": "string",
						"defaultValue": "material_exclusion"
					},
					"job_name_exclusion": {
						"type": "string",
						"defaultValue": "Archive_and_Load_Exclusion_File"
					},
					"mapping_exclusion": {
						"type": "string",
						"defaultValue": "{   \"type\": \"TabularTranslator\",   \"mappings\": [     {       \"source\": {         \"name\": \"TU\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"tradeunit\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Packaging Spec #\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"material_spec\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Description\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"material_description\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Division\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"material_division\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Point Person\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"point_person\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Notes\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"notes\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"file_name\",         \"type\": \"String\"       },       \"sink\": {         \"name\": \"exclusion_file_name\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     }   ] "
					},
					"container_exclusion": {
						"type": "string",
						"defaultValue": "clx-datalake/Curated/RnD/Adhoc_Files/Exclusion"
					},
					"container_substitution": {
						"type": "string",
						"defaultValue": "clx-datalake/Curated/RnD/Adhoc_Files/Substitution"
					},
					"container_export": {
						"type": "string",
						"defaultValue": "clx-datalake/Curated/RnD/Adhoc_Files/Export"
					},
					"mapping_substitution": {
						"type": "string",
						"defaultValue": "{   \"type\": \"TabularTranslator\",                                                         \"mappings\": [                                                             {                                                                 \"source\": {                                                                     \"name\": \"Packaging Spec #\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_spec\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Description\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_description\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Division\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_division\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"PCR (%)\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_pcr\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Wt (g)\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_weight\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Point Person\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"point_person\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Notes\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"notes\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"file_name\",                                                                     \"type\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"substitution_file_name\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             }                                                         ]"
					},
					"mapping_export": {
						"type": "string",
						"defaultValue": "{   \"type\": \"TabularTranslator\",                                                         \"mappings\": [                                                             {                                                                 \"source\": {                                                                     \"name\": \"CY2020 Reporting Period\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"metric\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"VMS\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"vms\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Other Export\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"other_export\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Canada\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"canada\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"LATAM\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"latin_america\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"AMEA\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"amea\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Asia\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"asia\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Export Total\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"export_total\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Last Updated\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"last_updated\",                                                                     \"type\": \"DateTime\",                                                                     \"physicalType\": \"datetime\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"file_name\",                                                                     \"type\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"export_file_name\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             }                                                         ]"
					},
					"job_name_substitution": {
						"type": "string",
						"defaultValue": "Archive_and_Load_Substitution_File"
					},
					"job_name_export": {
						"type": "string",
						"defaultValue": "Archive_and_Load_Export_File"
					},
					"table_substitution_rnd": {
						"type": "string",
						"defaultValue": "material_substitution"
					},
					"table_export_rnd": {
						"type": "string",
						"defaultValue": "international_export"
					},
					"sp_exclusion": {
						"type": "string",
						"defaultValue": "[[Rnd].[usp_lnd_to_rnd_exclusion]"
					},
					"sp_export": {
						"type": "string",
						"defaultValue": "[[Rnd].[usp_lnd_to_rnd_export]"
					},
					"sp_substitutiton": {
						"type": "string",
						"defaultValue": "[[Rnd].[usp_lnd_to_rnd_substitution]"
					},
					"export_file_name_query": {
						"type": "string",
						"defaultValue": "export_file_name"
					},
					"exclusion_file_name_query": {
						"type": "string",
						"defaultValue": "exclusion_file_name"
					},
					"susbst_file_name_query": {
						"type": "string",
						"defaultValue": "substitution_file_name"
					},
					"mapping_exclusion_stg": {
						"type": "string",
						"defaultValue": " \"type\": \"TabularTranslator\",             \"mappings\": [                 {                     \"source\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"bigint\"                     },                     \"sink\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"INT_64\"                     }                 },                 {                     \"source\": {                         \"name\": \"tradeunit\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"tradeunit\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"created_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"created_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"exclusion_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"exclusion_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"varbinary\"                     },                     \"sink\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"BINARY\"                     }                 }             ]"
					},
					"mapping_export_stg": {
						"type": "string",
						"defaultValue": " \"type\": \"TabularTranslator\",             \"mappings\": [                 {                     \"source\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"bigint\"                     },                     \"sink\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"INT_64\"                     }                 },                 {                     \"source\": {                         \"name\": \"metric\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"metric\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"region\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"region\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"value\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"value\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"export_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"export_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"load_date\",                         \"type\": \"DateTime\",                         \"physicalType\": \"date\"                     },                     \"sink\": {                         \"name\": \"load_date\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"created_db_timetamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"created_db_timetamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 }             "
					},
					"mapping_subst_stg": {
						"type": "string",
						"defaultValue": " \"type\": \"TabularTranslator\",             \"mappings\": [                 {                     \"source\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"bigint\"                     },                     \"sink\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"INT_64\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_pcr\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_pcr\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_weight\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_weight\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"create_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"create_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"last_modified_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"last_modified_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"substitution_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"substitution_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"varbinary\"                     },                     \"sink\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"BINARY\"                     }                 }             ]"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"directory": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_Export_value": {
						"type": "String",
						"defaultValue": "PickFile_ExportFile_FTP_ADLS"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "PickFile_Sustainability_SFTP_ADLS"
					},
					"directory_sust": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_SFTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					},
					"job_name_exclusion": {
						"type": "String",
						"defaultValue": "PickFile_ExclusionFile_FTP_ADLS"
					},
					"job_name_substitution": {
						"type": "String",
						"defaultValue": "PickFile_SubstitutionFile_FTP_ADLS"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T08:12:10Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Adhoc_Files_ADLS_to_DB_updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set variable2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,4)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(or(or(equals(variables('filename_trim_value'),'Expo'),equals(variables('filename_trim_value'),'Excl')), equals(variables('filename_trim_value'),'Pack')), equals(variables('filename_trim_value'), 'TU M'))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Execute_Fail_Alert_Adhoc_File_Name_incorrect",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_email",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Switch_File_Type_copy1",
									"type": "Switch",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@variables('filename_trim_value')",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "Expo",
												"activities": [
													{
														"name": "PF_Export_Job_Name_copy1",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_Export_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Export",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Export_Job_Name_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Export_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Export",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Export",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Export').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.exec_status",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Reuse FTP Adhoc Export",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Export",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "Pl_Reuse_FTP_Adhoc_Files_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Export').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Export').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"directory_ftp": {
																	"value": "@pipeline().parameters.directory_ftp",
																	"type": "Expression"
																},
																"sheet": {
																	"value": "@pipeline().parameters.sheet_export",
																	"type": "Expression"
																},
																"range": {
																	"value": "@pipeline().parameters.range_export",
																	"type": "Expression"
																},
																"filesystem_adls": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_adhoc_files": {
																	"value": "@pipeline().parameters.directory_export",
																	"type": "Expression"
																},
																"file_name_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"table_name_adhoc": {
																	"value": "@pipeline().parameters.table_export",
																	"type": "Expression"
																},
																"schema_ftp": {
																	"value": "@pipeline().parameters.schema_ftp",
																	"type": "Expression"
																},
																"json_mapping": {
																	"value": "@pipeline().parameters.mapping_export",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table_job_run_log": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"table_job_file_log": {
																	"value": "@pipeline().parameters.table_job_file_log",
																	"type": "Expression"
																},
																"table_job_control": {
																	"value": "@pipeline().parameters.table_job_control",
																	"type": "Expression"
																},
																"stored_procedure": {
																	"value": "@pipeline().parameters.sp_export",
																	"type": "Expression"
																},
																"filename_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"file_extension": {
																	"value": "@pipeline().parameters.file_extension",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Export",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Staging to Curated Export",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Tran_Adhoc_Files_Target_Table_to_Curated_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_export_rnd",
																	"type": "Expression"
																},
																"container": {
																	"value": "@pipeline().parameters.container_export",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('lookup1_copy1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_name_exclusion_value": {
																	"value": "@pipeline().parameters.job_name_export",
																	"type": "Expression"
																},
																"mapping_dynamic": {
																	"value": "@pipeline().parameters.mapping_export_stg",
																	"type": "Expression"
																},
																"file_name_query": {
																	"value": "@pipeline().parameters.export_file_name_query",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Failure Alert Export",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Export",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Staging to Curated Export",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Export').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "Excl",
												"activities": [
													{
														"name": "PF_Export_Job_Name_Exclusion",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_exclusion')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Exclusion",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Export_Job_Name_Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Export_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Exclusion",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Exclusion').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.exec_status",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Staging to Curated Exclusion",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Tran_Adhoc_Files_Target_Table_to_Curated_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_exclusion_rnd",
																	"type": "Expression"
																},
																"container": {
																	"value": "@pipeline().parameters.container_exclusion",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('lookup1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_name_exclusion_value": {
																	"value": "@pipeline().parameters.job_name_exclusion",
																	"type": "Expression"
																},
																"mapping_dynamic": {
																	"value": "@pipeline().parameters.mapping_exclusion_stg",
																	"type": "Expression"
																},
																"file_name_query": {
																	"value": "@pipeline().parameters.exclusion_file_name_query",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Reuse FTP Exclusion",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "Pl_Reuse_FTP_Adhoc_Files_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Exclusion').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Exclusion').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"directory_ftp": {
																	"value": "@pipeline().parameters.directory_ftp",
																	"type": "Expression"
																},
																"sheet": {
																	"value": "@pipeline().parameters.sheet_exclusion",
																	"type": "Expression"
																},
																"range": {
																	"value": "@pipeline().parameters.range_exclusion",
																	"type": "Expression"
																},
																"filesystem_adls": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_adhoc_files": {
																	"value": "@pipeline().parameters.directory_exclusion",
																	"type": "Expression"
																},
																"file_name_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"table_name_adhoc": {
																	"value": "@pipeline().parameters.table_exclusion",
																	"type": "Expression"
																},
																"schema_ftp": {
																	"value": "@pipeline().parameters.schema_ftp",
																	"type": "Expression"
																},
																"json_mapping": {
																	"value": "@pipeline().parameters.mapping_exclusion",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table_job_run_log": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"table_job_file_log": {
																	"value": "@pipeline().parameters.table_job_file_log",
																	"type": "Expression"
																},
																"table_job_control": {
																	"value": "@pipeline().parameters.table_job_control",
																	"type": "Expression"
																},
																"stored_procedure": {
																	"value": "@pipeline().parameters.sp_exclusion",
																	"type": "Expression"
																},
																"filename_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"file_extension": {
																	"value": "@pipeline().parameters.file_extension",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Exclusion",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute  Fail Alert Exclusion",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Exclusion",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Staging to Curated Exclusion",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Exclusion').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "Pack",
												"activities": [
													{
														"name": "LKP_Job_Key_Substitution",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Export_Job_Name_Substitution",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_substitution'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Substitution",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Substitution",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Substitution').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.exec_status",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "PF_Export_Job_Name_Substitution",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_substitution')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "Execute Reuse FTP Adhoc Subst",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Substitution",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "Pl_Reuse_FTP_Adhoc_Files_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Substitution').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Substitution').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"directory_ftp": {
																	"value": "@pipeline().parameters.directory_ftp",
																	"type": "Expression"
																},
																"sheet": {
																	"value": "@pipeline().parameters.sheet_substitutions",
																	"type": "Expression"
																},
																"range": {
																	"value": "@pipeline().parameters.range_substitution",
																	"type": "Expression"
																},
																"filesystem_adls": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_adhoc_files": {
																	"value": "@pipeline().parameters.directory_substitution",
																	"type": "Expression"
																},
																"file_name_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"table_name_adhoc": {
																	"value": "@pipeline().parameters.table_substitution",
																	"type": "Expression"
																},
																"schema_ftp": {
																	"value": "@pipeline().parameters.schema_ftp",
																	"type": "Expression"
																},
																"json_mapping": {
																	"value": "@pipeline().parameters.mapping_substitution",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table_job_run_log": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"table_job_file_log": {
																	"value": "@pipeline().parameters.table_job_file_log",
																	"type": "Expression"
																},
																"table_job_control": {
																	"value": "@pipeline().parameters.table_job_control",
																	"type": "Expression"
																},
																"stored_procedure": {
																	"value": "@pipeline().parameters.sp_substitutiton",
																	"type": "Expression"
																},
																"filename_concat": {
																	"value": "@variables('container')",
																	"type": "Expression"
																},
																"file_extension": {
																	"value": "@pipeline().parameters.file_extension",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1_file_key",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Subst",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Staging to Curated Subst",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1_file_key",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Tran_Adhoc_Files_Target_Table_to_Curated_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_substitution_rnd",
																	"type": "Expression"
																},
																"container": {
																	"value": "@pipeline().parameters.container_export",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('Lookup1_File_key').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_name_exclusion_value": {
																	"value": "@pipeline().parameters.job_name_substitution",
																	"type": "Expression"
																},
																"mapping_dynamic": {
																	"value": "@pipeline().parameters.mapping_subst_stg",
																	"type": "Expression"
																},
																"file_name_query": {
																	"value": "@pipeline().parameters.susbst_file_name_query",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Failure Alert Subst",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Reuse FTP Adhoc Subst",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Staging to Curated Subst",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Substitution').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "TU M",
												"activities": [
													{
														"name": "Copyfrom_FTP_to_Raw_Manual_Subs",
														"type": "Copy",
														"dependsOn": [],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "ExcelSource",
																"storeSettings": {
																	"type": "FtpReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false,
																	"useBinaryTransfer": true
																}
															},
															"sink": {
																"type": "DelimitedTextSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "DelimitedTextWriteSettings",
																	"quoteAllText": true,
																	"fileExtension": {
																		"value": "@pipeline().parameters.file_extension",
																		"type": "Expression"
																	}
																}
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_FTP_All_Files",
																"type": "DatasetReference",
																"parameters": {
																	"directory": {
																		"value": "@pipeline().parameters.directory_ftp",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	},
																	"sheet_name": {
																		"value": "@pipeline().parameters.sheet_manual_substitution",
																		"type": "Expression"
																	},
																	"range": {
																		"value": "@pipeline().parameters.range_manual_substitution",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_ADLS_PLM_EBOM_copy2",
																"type": "DatasetReference",
																"parameters": {
																	"filesystem": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_substitution",
																		"type": "Expression"
																	},
																	"filename": "@concat(variables('container'),'.xlsx')"
																}
															}
														]
													},
													{
														"name": "Copy_from_raw_to_Temp_table_manua_Subst",
														"type": "Copy",
														"dependsOn": [
															{
																"activity": "Copyfrom_FTP_to_Raw_Manual_Subs",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "DelimitedTextSource",
																"additionalColumns": [
																	{
																		"name": "substitution_file_name",
																		"value": {
																			"value": "@pipeline().parameters.file_name",
																			"type": "Expression"
																		}
																	}
																],
																"storeSettings": {
																	"type": "AzureBlobStorageReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false
																},
																"formatSettings": {
																	"type": "DelimitedTextReadSettings"
																}
															},
															"sink": {
																"type": "AzureSqlSink",
																"tableOption": "autoCreate"
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_ABLB_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_substitution",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_SQL_FTP_Files",
																"type": "DatasetReference",
																"parameters": {
																	"table": {
																		"value": "@pipeline().parameters.table_manual_substitution",
																		"type": "Expression"
																	},
																	"schema": {
																		"value": "@pipeline().parameters.schema_ftp",
																		"type": "Expression"
																	}
																}
															}
														]
													}
												]
											}
										],
										"defaultActivities": [
											{
												"name": "Set variable2_copy1",
												"type": "SetVariable",
												"dependsOn": [],
												"userProperties": [],
												"typeProperties": {
													"variableName": "df_name",
													"value": {
														"value": "@pipeline().DataFactory",
														"type": "Expression"
													}
												}
											}
										]
									}
								}
							]
						}
					},
					{
						"name": "Set variable2",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "container",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,indexof(pipeline().parameters.file_name,'.'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting"
					},
					"directory_export": {
						"type": "string",
						"defaultValue": "Raw/RnD/Adhoc_Files/Export"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"schema": {
						"type": "string",
						"defaultValue": "control_etl"
					},
					"file_size": {
						"type": "string"
					},
					"all_xlsx_files": {
						"type": "string",
						"defaultValue": "*.xlsx"
					},
					"directory_ftp": {
						"type": "string",
						"defaultValue": "Sustainability Reporting Manual Update Files"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".xlsx"
					},
					"schema_ftp": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_export": {
						"type": "string",
						"defaultValue": "lnd_international_export"
					},
					"table_exclusion": {
						"type": "string",
						"defaultValue": "lnd_material_exclusion"
					},
					"table_substitution": {
						"type": "string",
						"defaultValue": "lnd_material_substitution"
					},
					"sheet_export": {
						"type": "string",
						"defaultValue": "Summary"
					},
					"sheet_exclusion": {
						"type": "string",
						"defaultValue": "WIP"
					},
					"sheet_substitutions": {
						"type": "string",
						"defaultValue": "Substitutions"
					},
					"range_export": {
						"type": "string",
						"defaultValue": "A1:I36"
					},
					"range_exclusion": {
						"type": "string",
						"defaultValue": "A2:F42"
					},
					"range_substitution": {
						"type": "string",
						"defaultValue": "A3:G46"
					},
					"directory_exclusion": {
						"type": "string",
						"defaultValue": "Raw/RnD/Adhoc_Files/Exclusion"
					},
					"directory_substitution": {
						"type": "string",
						"defaultValue": "Raw/RnD/Adhoc_Files/Substitution"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In Progress"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"sheet_manual_substitution": {
						"type": "string",
						"defaultValue": "TU's"
					},
					"range_manual_substitution": {
						"type": "string",
						"defaultValue": "E1:Q4"
					},
					"table_manual_substitution": {
						"type": "string",
						"defaultValue": "lnd_manual_substituion"
					},
					"table_exclusion_rnd": {
						"type": "string",
						"defaultValue": "material_exclusion"
					},
					"job_name_exclusion": {
						"type": "string",
						"defaultValue": "Archive_and_Load_Exclusion_File"
					},
					"mapping_exclusion": {
						"type": "string",
						"defaultValue": "{   \"type\": \"TabularTranslator\",   \"mappings\": [     {       \"source\": {         \"name\": \"TU\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"tradeunit\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Packaging Spec #\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"material_spec\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Description\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"material_description\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Division\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"material_division\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Point Person\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"point_person\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"Notes\",         \"type\": \"String\",         \"physicalType\": \"String\"       },       \"sink\": {         \"name\": \"notes\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     },     {       \"source\": {         \"name\": \"file_name\",         \"type\": \"String\"       },       \"sink\": {         \"name\": \"exclusion_file_name\",         \"type\": \"String\",         \"physicalType\": \"varchar\"       }     }   ] "
					},
					"container_exclusion": {
						"type": "string",
						"defaultValue": "clx-datalake/Curated/RnD/Adhoc_Files/Exclusion"
					},
					"container_substitution": {
						"type": "string",
						"defaultValue": "clx-datalake/Curated/RnD/Adhoc_Files/Substitution"
					},
					"container_export": {
						"type": "string",
						"defaultValue": "clx-datalake/Curated/RnD/Adhoc_Files/Export"
					},
					"mapping_substitution": {
						"type": "string",
						"defaultValue": "{   \"type\": \"TabularTranslator\",                                                         \"mappings\": [                                                             {                                                                 \"source\": {                                                                     \"name\": \"Packaging Spec #\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_spec\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Description\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_description\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Division\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_division\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"PCR (%)\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_pcr\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Wt (g)\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"material_weight\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Point Person\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"point_person\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Notes\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"notes\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"file_name\",                                                                     \"type\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"substitution_file_name\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             }                                                         ]"
					},
					"mapping_export": {
						"type": "string",
						"defaultValue": "{   \"type\": \"TabularTranslator\",                                                         \"mappings\": [                                                             {                                                                 \"source\": {                                                                     \"name\": \"CY2020 Reporting Period\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"metric\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"VMS\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"vms\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Other Export\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"other_export\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Canada\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"canada\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"LATAM\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"latin_america\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"AMEA\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"amea\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Asia\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"asia\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Export Total\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"export_total\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"Last Updated\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"last_updated\",                                                                     \"type\": \"DateTime\",                                                                     \"physicalType\": \"datetime\"                                                                 }                                                             },                                                             {                                                                 \"source\": {                                                                     \"name\": \"file_name\",                                                                     \"type\": \"String\"                                                                 },                                                                 \"sink\": {                                                                     \"name\": \"export_file_name\",                                                                     \"type\": \"String\",                                                                     \"physicalType\": \"varchar\"                                                                 }                                                             }                                                         ]"
					},
					"job_name_substitution": {
						"type": "string",
						"defaultValue": "Archive_and_Load_Substitution_File"
					},
					"job_name_export": {
						"type": "string",
						"defaultValue": "Archive_and_Load_Export_File"
					},
					"table_substitution_rnd": {
						"type": "string",
						"defaultValue": "material_substitution"
					},
					"table_export_rnd": {
						"type": "string",
						"defaultValue": "international_export"
					},
					"sp_exclusion": {
						"type": "string",
						"defaultValue": "[[Rnd].[usp_lnd_to_rnd_exclusion]"
					},
					"sp_export": {
						"type": "string",
						"defaultValue": "[[Rnd].[usp_lnd_to_rnd_export]"
					},
					"sp_substitutiton": {
						"type": "string",
						"defaultValue": "[[Rnd].[usp_lnd_to_rnd_substitution]"
					},
					"export_file_name_query": {
						"type": "string",
						"defaultValue": "export_file_name"
					},
					"exclusion_file_name_query": {
						"type": "string",
						"defaultValue": "exclusion_file_name"
					},
					"susbst_file_name_query": {
						"type": "string",
						"defaultValue": "substitution_file_name"
					},
					"mapping_exclusion_stg": {
						"type": "string",
						"defaultValue": " \"type\": \"TabularTranslator\",             \"mappings\": [                 {                     \"source\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"bigint\"                     },                     \"sink\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"INT_64\"                     }                 },                 {                     \"source\": {                         \"name\": \"tradeunit\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"tradeunit\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"created_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"created_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"exclusion_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"exclusion_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"varbinary\"                     },                     \"sink\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"BINARY\"                     }                 }             ]"
					},
					"mapping_export_stg": {
						"type": "string",
						"defaultValue": " \"type\": \"TabularTranslator\",             \"mappings\": [                 {                     \"source\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"bigint\"                     },                     \"sink\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"INT_64\"                     }                 },                 {                     \"source\": {                         \"name\": \"metric\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"metric\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"region\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"region\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"value\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"value\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"export_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"export_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"load_date\",                         \"type\": \"DateTime\",                         \"physicalType\": \"date\"                     },                     \"sink\": {                         \"name\": \"load_date\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"created_db_timetamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"created_db_timetamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"last_modified_db_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 }             "
					},
					"mapping_subst_stg": {
						"type": "string",
						"defaultValue": " \"type\": \"TabularTranslator\",             \"mappings\": [                 {                     \"source\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"bigint\"                     },                     \"sink\": {                         \"name\": \"seq_id\",                         \"type\": \"Int64\",                         \"physicalType\": \"INT_64\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_spec\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_description\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"material_division\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_pcr\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_pcr\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"material_weight\",                         \"type\": \"Double\",                         \"physicalType\": \"float\"                     },                     \"sink\": {                         \"name\": \"material_weight\",                         \"type\": \"Double\",                         \"physicalType\": \"DOUBLE\"                     }                 },                 {                     \"source\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"point_person\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"notes\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"create_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"create_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"last_modified_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"datetime\"                     },                     \"sink\": {                         \"name\": \"last_modified_timestamp\",                         \"type\": \"DateTime\",                         \"physicalType\": \"INT_96\"                     }                 },                 {                     \"source\": {                         \"name\": \"substitution_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"varchar\"                     },                     \"sink\": {                         \"name\": \"substitution_file_name\",                         \"type\": \"String\",                         \"physicalType\": \"UTF8\"                     }                 },                 {                     \"source\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"varbinary\"                     },                     \"sink\": {                         \"name\": \"hashkey\",                         \"type\": \"Byte[]\",                         \"physicalType\": \"BINARY\"                     }                 }             ]"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"directory": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_Export_value": {
						"type": "String",
						"defaultValue": "PickFile_ExportFile_FTP_ADLS"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "PickFile_Sustainability_SFTP_ADLS"
					},
					"directory_sust": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_SFTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					},
					"job_name_exclusion": {
						"type": "String",
						"defaultValue": "PickFile_ExclusionFile_FTP_ADLS"
					},
					"job_name_substitution": {
						"type": "String",
						"defaultValue": "PickFile_SubstitutionFile_FTP_ADLS"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T14:14:29Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_EBOM_Raw_Directory_to_DB')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_EBOM_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_EBOM",
							"value": {
								"value": "@variables('job_name_EBOM_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_EBOM",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_EBOM_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_EBOM_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_EBOM",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_EBOM_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ebom_filename",
										"value": {
											"value": "@pipeline().parameters.filename_ebom",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Level ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "level",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": " RelationName ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "relation_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " From or To ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "from_or_to",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Type ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Part ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_part",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Description ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Spec ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_specification",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Quantity ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_quantity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Division",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_division",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Rev ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "revision",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecyclablePlasticWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recyclable_plastic_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecycleWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recycle_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PackageReuseWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "package_reuse_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " CompostableWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "compostable_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PlasticWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "plastic_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Coutry of Origin ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "country_of_origin",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Certification Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "certification_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Created Date ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "created_date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Last Modified Date ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "last_modified_date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ebom_filename",
											"type": "String"
										},
										"sink": {
											"name": "ebom_file_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecyclablePlasticWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recyclable_plastic_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecycleWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recycle_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PackageReuseWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "package_reuse_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " CompostableWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "compostable_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PlasticWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "plastic_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ABLB_LZ_LT",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename_ebom",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_ebom",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Update_Records_In_Run_Log_copy1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_EBOM_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_Zone_EBOM_to_Landing_Table').output.rowsCopied ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_Zone_EBOM_to_Landing_Table').output.rowsRead , ' where  job_key = ' ,activity('LKP_Job_Key_EBOM').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SP_landing_to_Staging_EBOM",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LKP_Update_Records_In_Run_Log_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_ebom]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename_ebom",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Execute_Staging_to_Curated_Pipeline_EBOM",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_Sustainability_Staging_Table_to_Curated_ADLS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename_ebom",
									"type": "Expression"
								},
								"action_insert": {
									"value": "@pipeline().parameters.action_insert",
									"type": "Expression"
								},
								"exec_status": {
									"value": "@pipeline().parameters.exec_status",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.filesize_ebom",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@pipeline().parameters.job_file_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_landing_to_Staging_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_EBOM",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename_ebom",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filesize_ebom",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_EBOM_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "ETL"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/EBOM"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"table_ebom": {
						"type": "string",
						"defaultValue": "lnd_ebom"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"filename_ebom": {
						"type": "string"
					},
					"filesize_ebom": {
						"type": "string"
					},
					"job_key": {
						"type": "string"
					},
					"job_run_key": {
						"type": "string"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"job_file_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_EBOM_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_EBOM_LZ_LT"
					},
					"job_name_EBOM": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T11:04:52Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_EBOM_Raw_Directory_to_DB_Updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_EBOM_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_EBOM",
							"value": {
								"value": "@variables('job_name_EBOM_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_EBOM",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_EBOM_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_EBOM_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_EBOM",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_EBOM_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ebom_filename",
										"value": {
											"value": "@pipeline().parameters.filename_ebom",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Level ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "level",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": " RelationName ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "relation_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " From or To ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "from_or_to",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Type ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Part ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_part",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Description ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Spec ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_specification",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Quantity ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_quantity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Division",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_division",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Rev ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "revision",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecyclablePlasticWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recyclable_plastic_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecycleWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recycle_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PackageReuseWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "package_reuse_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " CompostableWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "compostable_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PlasticWeight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "plastic_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Coutry of Origin ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "country_of_origin",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Certification Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "certification_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Created Date ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "created_date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Last Modified Date ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "last_modified_date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ebom_filename",
											"type": "String"
										},
										"sink": {
											"name": "ebom_file_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecyclablePlasticWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recyclable_plastic_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " RecycleWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "recycle_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PackageReuseWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "package_reuse_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " CompostableWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "compostable_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PlasticWeight_UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "plastic_weight_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ABLB_LZ_LT",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename_ebom",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_ebom",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "SP_landing_to_Staging_EBOM",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_EBOM_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_ebom]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename_ebom",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Execute_Staging_to_Curated_Pipeline_EBOM",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_EBOM_Staging_Table_to_Curated_ADLS_Updated",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename_ebom",
									"type": "Expression"
								},
								"action_insert": {
									"value": "@pipeline().parameters.action_insert",
									"type": "Expression"
								},
								"exec_status": {
									"value": "@pipeline().parameters.exec_status",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.filesize_ebom",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@pipeline().parameters.job_file_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_landing_to_Staging_EBOM",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_EBOM",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename_ebom",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filesize_ebom",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_EBOM').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									},
									"datafactory_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"pipeline_trigger_time": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"pipeline_trigger_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerId",
											"type": "Expression"
										}
									},
									"pipeline_run_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"pipeline_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_EBOM_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							},
							{
								"activity": "Execute_Staging_to_Curated_Pipeline_EBOM",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_EBOM').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "control_ETL"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/EBOM"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"table_ebom": {
						"type": "string",
						"defaultValue": "lnd_ebom"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"filename_ebom": {
						"type": "string"
					},
					"filesize_ebom": {
						"type": "string"
					},
					"job_key": {
						"type": "string"
					},
					"job_run_key": {
						"type": "string"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"job_file_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_EBOM_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_EBOM_LZ_LT"
					},
					"job_name_EBOM": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T14:21:58Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Material_Type_SFTP_to_ADLS_to_DB')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_from_SFTP_to_ADLS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "SftpReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SFTP_EBOM",
								"type": "DatasetReference",
								"parameters": {
									"directory": {
										"value": "@pipeline().globalParameters.directory_sftp",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.file",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ABLB_EBOM",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.container",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_adls",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "PF_Material_type_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name",
							"value": {
								"value": "@variables('job_name_material')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_Material_type_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_material'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_File_Log_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_from_SFTP_to_ADLS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_adls",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_run_key')",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": null
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_from_ADLS_to_DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "material_filenname",
										"value": {
											"value": "@pipeline().parameters.file",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Material Type Categorization ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_type_categorization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Part Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "part_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "material_filenname",
											"type": "String"
										},
										"sink": {
											"name": "material_type_filename",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ABLB_LZ_LT",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.container",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_adls",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.file",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_material",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_material_type",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Update_Records_In_Run_Log_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_from_ADLS_to_DB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_from_ADLS_to_DB').output.dataWritten ,  ',' ,  ' records_read = ' , activity('Copy_from_ADLS_to_DB').output.dataRead , ' where  job_key = ' , activity('LKP_Job_Key_Material_Type').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_Material_Type').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SP_Job_Run_Status_Material_Type",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LKP_Update_Records_In_Run_Log_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_Material_Type').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Execute_PL_Rnd_to_Curated_material",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_Material_Type_Target_Table_to_Curated_ADLS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_Material_Type').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.file",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@activity('LKP_Job_File_Log_Material_Type').output.firstRow.job_file_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting/"
					},
					"file": {
						"type": "string",
						"defaultValue": "Material_Type.csv"
					},
					"container": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_adls": {
						"type": "string",
						"defaultValue": "Raw/RnD/Material_Type"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"schema": {
						"type": "string",
						"defaultValue": "etl"
					},
					"schema_material": {
						"type": "string",
						"defaultValue": "rnd"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"file_size": {
						"type": "string"
					},
					"table_material_type": {
						"type": "string",
						"defaultValue": "material_type"
					}
				},
				"variables": {
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_material": {
						"type": "String",
						"defaultValue": "PickFile_Material_Type_SFTP_ADLS"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-16T07:15:40Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Material_Type_SFTP_to_ADLS_to_DB_updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_from_SFTP_to_ADLS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "SftpReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SFTP_EBOM",
								"type": "DatasetReference",
								"parameters": {
									"directory": {
										"value": "@pipeline().globalParameters.directory_sftp",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.file",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ABLB_EBOM",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.container",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_adls",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "PF_Material_type_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name",
							"value": {
								"value": "@variables('job_name_material')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_Material_type_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_material'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_File_Log_Material_Type",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_from_SFTP_to_ADLS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_adls",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_run_key')",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": null
									},
									"datafactory_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"pipeline_trigger_time": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"pipeline_trigger_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerId",
											"type": "Expression"
										}
									},
									"pipeline_run_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"pipeline_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_from_ADLS_to_DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "material_filenname",
										"value": {
											"value": "@pipeline().parameters.file",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Material Type Categorization ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_type_categorization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Part Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "part_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "material_filenname",
											"type": "String"
										},
										"sink": {
											"name": "material_type_filename",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ABLB_LZ_LT",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.container",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_adls",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.file",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_material",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_material_type",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "SP_Job_Run_Status_Material_Type",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy_from_ADLS_to_DB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_Material_Type').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Execute_PL_Rnd_to_Curated_material",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Material_Type",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_Material_Type_Target_Table_to_Curated_ADLS_Updated",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_Material_Type').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.file",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@activity('LKP_Job_File_Log_Material_Type').output.firstRow.job_file_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting/"
					},
					"file": {
						"type": "string",
						"defaultValue": "Material_Type.csv"
					},
					"container": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_adls": {
						"type": "string",
						"defaultValue": "Raw/RnD/Material_Type"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"schema": {
						"type": "string",
						"defaultValue": "control_etl"
					},
					"schema_material": {
						"type": "string",
						"defaultValue": "rnd"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"file_size": {
						"type": "string"
					},
					"table_material_type": {
						"type": "string",
						"defaultValue": "material_type"
					}
				},
				"variables": {
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_material": {
						"type": "String",
						"defaultValue": "PickFile_Material_Type_SFTP_ADLS"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T13:21:56Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_SAP_File_Raw_Directory_to_DB')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_SAP_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_SAP",
							"value": {
								"value": "@variables('job_name_SAP_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_SAP_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_SAP_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.execution_status",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "sap_filename",
										"value": {
											"value": "@pipeline().parameters.filename",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings",
									"skipLineCount": 2
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 1
										},
										"sink": {
											"name": "customer_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 2
										},
										"sink": {
											"name": "customer_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 3
										},
										"sink": {
											"name": "corporate_custhier1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 4
										},
										"sink": {
											"name": "corp_custhier1_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 5
										},
										"sink": {
											"name": "subsidiary_custhier2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 6
										},
										"sink": {
											"name": "subs_custhier2_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 7
										},
										"sink": {
											"name": "reg_div_custhier3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 8
										},
										"sink": {
											"name": "reg_div_custhier3_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 9
										},
										"sink": {
											"name": "broker_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 10
										},
										"sink": {
											"name": "broker_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 11
										},
										"sink": {
											"name": "profit_center",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 12
										},
										"sink": {
											"name": "profit_center_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 13
										},
										"sink": {
											"name": "material_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 14
										},
										"sink": {
											"name": "material_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 15
										},
										"sink": {
											"name": "division_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 16
										},
										"sink": {
											"name": "material_division_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 17
										},
										"sink": {
											"name": "global_category",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 18
										},
										"sink": {
											"name": "global_category_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 19
										},
										"sink": {
											"name": "brand_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 20
										},
										"sink": {
											"name": "brand_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 21
										},
										"sink": {
											"name": "purpose_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 22
										},
										"sink": {
											"name": "purpose_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 23
										},
										"sink": {
											"name": "type_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 24
										},
										"sink": {
											"name": "type_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 25
										},
										"sink": {
											"name": "package_size",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 26
										},
										"sink": {
											"name": "package_size_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 27
										},
										"sink": {
											"name": "european_article_numbers_universal_product_code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 28
										},
										"sink": {
											"name": "region_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 29
										},
										"sink": {
											"name": "regional_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 30
										},
										"sink": {
											"name": "sales_organization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 31
										},
										"sink": {
											"name": "sales_organization_decsription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 32
										},
										"sink": {
											"name": "trade_sector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 33
										},
										"sink": {
											"name": "trade_sector_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 34
										},
										"sink": {
											"name": "country_key",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 35
										},
										"sink": {
											"name": "country_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 36
										},
										"sink": {
											"name": "sales_department_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 37
										},
										"sink": {
											"name": "sales_department_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 38
										},
										"sink": {
											"name": "sector_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 39
										},
										"sink": {
											"name": "sector_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 40
										},
										"sink": {
											"name": "controlling_area",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 41
										},
										"sink": {
											"name": "controlling_area_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 42
										},
										"sink": {
											"name": "distribution_channel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 43
										},
										"sink": {
											"name": "distribution_channel_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 44
										},
										"sink": {
											"name": "calendar_year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 45
										},
										"sink": {
											"name": "calendar_year_month",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 46
										},
										"sink": {
											"name": "calendar_month",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 47
										},
										"sink": {
											"name": "fiscal_year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 48
										},
										"sink": {
											"name": "posting_period",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 49
										},
										"sink": {
											"name": "fiscal_year_variant",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 50
										},
										"sink": {
											"name": "base_unit_of_measure_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 51
										},
										"sink": {
											"name": "quantity_in_base_units_of_measure",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 52
										},
										"sink": {
											"name": "base_unit_of_measure_uom2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 53
										},
										"sink": {
											"name": "dos_quantity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 54
										},
										"sink": {
											"name": "statistics_currency",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 55
										},
										"sink": {
											"name": "net_value_statistics_currency",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sap_filename",
											"type": "String"
										},
										"sink": {
											"name": "sap_filename",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ADLS_PLM_SAP",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_sap",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Update_Records_In_Run_Log",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_Zone_SAP_to_Landing_Table').output.rowsCopied ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_Zone_SAP_to_Landing_Table').output.rowsRead , ' where  job_key = ' ,activity('LKP_Job_Key_SAP').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Landing_to_Staging_SAP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LKP_Update_Records_In_Run_Log",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_sap]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_Landing_to_Staging_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_PL_Stg_to_Curated_SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_SAP_File_Staging_Table_to_Curated_ADLS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.file_size",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@activity('LKP_Job_File_Log_SAP').output.firstRow.job_file_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "ETL"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_sap": {
						"type": "string",
						"defaultValue": "lnd_sap_bw"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"execution_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"file_size": {
						"type": "string"
					},
					"skip_line_count": {
						"type": "int",
						"defaultValue": 2
					},
					"filename": {
						"type": "string"
					},
					"job_file_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_SAP_LZ_LT"
					},
					"job_name_SAP": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T11:04:52Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_SAP_File_Raw_Directory_to_DB_Updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_SAP_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_SAP",
							"value": {
								"value": "@variables('job_name_SAP_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_SAP_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_SAP_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.execution_status",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "sap_filename",
										"value": {
											"value": "@pipeline().parameters.filename",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings",
									"skipLineCount": 2
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 1
										},
										"sink": {
											"name": "customer_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 2
										},
										"sink": {
											"name": "customer_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 3
										},
										"sink": {
											"name": "corporate_custhier1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 4
										},
										"sink": {
											"name": "corp_custhier1_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 5
										},
										"sink": {
											"name": "subsidiary_custhier2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 6
										},
										"sink": {
											"name": "subs_custhier2_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 7
										},
										"sink": {
											"name": "reg_div_custhier3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 8
										},
										"sink": {
											"name": "reg_div_custhier3_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 9
										},
										"sink": {
											"name": "broker_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 10
										},
										"sink": {
											"name": "broker_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 11
										},
										"sink": {
											"name": "profit_center",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 12
										},
										"sink": {
											"name": "profit_center_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 13
										},
										"sink": {
											"name": "material_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 14
										},
										"sink": {
											"name": "material_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 15
										},
										"sink": {
											"name": "division_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 16
										},
										"sink": {
											"name": "material_division_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 17
										},
										"sink": {
											"name": "global_category",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 18
										},
										"sink": {
											"name": "global_category_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 19
										},
										"sink": {
											"name": "brand_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 20
										},
										"sink": {
											"name": "brand_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 21
										},
										"sink": {
											"name": "purpose_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 22
										},
										"sink": {
											"name": "purpose_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 23
										},
										"sink": {
											"name": "type_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 24
										},
										"sink": {
											"name": "type_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 25
										},
										"sink": {
											"name": "package_size",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 26
										},
										"sink": {
											"name": "package_size_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 27
										},
										"sink": {
											"name": "european_article_numbers_universal_product_code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 28
										},
										"sink": {
											"name": "region_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 29
										},
										"sink": {
											"name": "regional_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 30
										},
										"sink": {
											"name": "sales_organization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 31
										},
										"sink": {
											"name": "sales_organization_decsription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 32
										},
										"sink": {
											"name": "trade_sector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 33
										},
										"sink": {
											"name": "trade_sector_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 34
										},
										"sink": {
											"name": "country_key",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 35
										},
										"sink": {
											"name": "country_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 36
										},
										"sink": {
											"name": "sales_department_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 37
										},
										"sink": {
											"name": "sales_department_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 38
										},
										"sink": {
											"name": "sector_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 39
										},
										"sink": {
											"name": "sector_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 40
										},
										"sink": {
											"name": "controlling_area",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 41
										},
										"sink": {
											"name": "controlling_area_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 42
										},
										"sink": {
											"name": "distribution_channel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 43
										},
										"sink": {
											"name": "distribution_channel_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 44
										},
										"sink": {
											"name": "calendar_year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 45
										},
										"sink": {
											"name": "calendar_year_month",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 46
										},
										"sink": {
											"name": "calendar_month",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 47
										},
										"sink": {
											"name": "fiscal_year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 48
										},
										"sink": {
											"name": "posting_period",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 49
										},
										"sink": {
											"name": "fiscal_year_variant",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 50
										},
										"sink": {
											"name": "base_unit_of_measure_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 51
										},
										"sink": {
											"name": "quantity_in_base_units_of_measure",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 52
										},
										"sink": {
											"name": "base_unit_of_measure_uom2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 53
										},
										"sink": {
											"name": "dos_quantity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 54
										},
										"sink": {
											"name": "statistics_currency",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 55
										},
										"sink": {
											"name": "net_value_statistics_currency",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sap_filename",
											"type": "String"
										},
										"sink": {
											"name": "sap_filename",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ADLS_PLM_SAP",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_sap",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							},
							{
								"activity": "Execute_PL_Stg_to_Curated_SAP",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Landing_to_Staging_SAP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_sap]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_Landing_to_Staging_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									},
									"datafactory_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"pipeline_trigger_time": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"pipeline_trigger_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerId",
											"type": "Expression"
										}
									},
									"pipeline_run_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"pipeline_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_PL_Stg_to_Curated_SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_SAP_File_Staging_Table_to_Curated_ADLS_Updated",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.file_size",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@activity('LKP_Job_File_Log_SAP').output.firstRow.job_file_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "control_etl"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_sap": {
						"type": "string",
						"defaultValue": "lnd_sap_bw"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"execution_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"file_size": {
						"type": "string"
					},
					"skip_line_count": {
						"type": "int",
						"defaultValue": 2
					},
					"filename": {
						"type": "string"
					},
					"job_file_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_SAP_LZ_LT"
					},
					"job_name_SAP": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T15:01:32Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_SAP_Hub_Raw_Zone_to_Landing_Table')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_SAP_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_SAP",
							"value": {
								"value": "@variables('job_name_SAP_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_SAP_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_SAP_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@variables('job_key')",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.execution_status",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "sap_hub_file_name",
										"value": {
											"value": "@pipeline().parameters.filename",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CUST_HIE01",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "corporate_custhier1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NAME2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "corp_custhier1_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CUST_HIE02",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "subsidiary_custhier2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NAME3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "subs_custhier2_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CUST_HIE03",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "reg_div_custhier3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NAME40",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "reg_div_custhier3_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/ZBROKER",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "broker_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME5",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "broker_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PROFIT_CTR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "profit_center",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TXTMD",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "profit_center_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME4",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DIVISION",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "division_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TXTSH",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_division_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRODH1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "global_category",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME6",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "global_category_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRODH2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "brand_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME7",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "brand_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRODH3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "purpose_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME8",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "purpose_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRODH4",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "type_number",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "type_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRODH5",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "package_size",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME10",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "package_size_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EANUPC",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "european_article_numbers_universal_product_code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/ZSLS_REGN",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "region_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME11",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "regional_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sales_organization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME12",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sales_organization_decsription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CUST_GRP5",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "trade_sector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME13",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "trade_sector_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "country_key",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME14",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "country_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/ZSLS_DEPT",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sales_department_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME15",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sales_department_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/ZSECTOR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sector_in_sales_dept_hierarchy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME16",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sector_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CO_AREA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "controlling_area",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME17",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "controlling_area_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "distribution_channel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME18",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "distribution_channel_description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CALYEAR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "calendar_year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "calendar_year_month",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CALMONTH2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "calendar_month",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FISCYEAR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "fiscal_year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FISCPER3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posting_period",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FISCVARNT",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "fiscal_year_variant",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "base_unit_of_measure_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "QUANT_B",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "quantity_in_base_units_of_measure",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BASE_UOM2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "base_unit_of_measure_uom2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "/BIC/ZDOS_QTY",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "dos_quantity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "STAT_CURR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "statistics_currency",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NET_VAL_S",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "net_value_statistics_currency",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sap_hub_file_name",
											"type": "String"
										},
										"sink": {
											"name": "sap_filename",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ADLS_PLM_EBOM_copy3",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"filename": {
										"value": "@pipeline().parameters.filename",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_sap",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Update_Records_In_Run_Log",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_Zone_SAP_to_Landing_Table').output.rowsCopied ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_Zone_SAP_to_Landing_Table').output.rowsRead , ' where  job_key = ' ,activity('LKP_Job_Key_SAP').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_SAP_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Landing_to_Staging_SAP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LKP_Update_Records_In_Run_Log",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_sap_hub]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_Landing_to_Staging_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_PL_Stg_to_Curated_SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_SAP_Hub_Staging_Table_to_Curated_ADLS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.file_size",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@activity('LKP_Job_File_Log_SAP').output.firstRow.job_file_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "ETL"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_sap": {
						"type": "string",
						"defaultValue": "lnd_sap_hub"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"execution_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"file_size": {
						"type": "string"
					},
					"skip_line_count": {
						"type": "int",
						"defaultValue": 2
					},
					"filename": {
						"type": "string"
					},
					"job_file_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_SAP_LZ_LT"
					},
					"job_name_SAP": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T11:04:52Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Sustainability_Raw_Directory_to_DB')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_Sustainability_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_Sustainability",
							"value": {
								"value": "@variables('job_name_Sustainability_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_Sustainability",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_Sustainability_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Sustainability_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_Sustainability",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_Sustainability_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "sust_filename",
										"value": {
											"value": "@pipeline().parameters.filename_sust",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Level ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "level",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": " RelationshipName ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "relation_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " From or To ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "from_or_to",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Type ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Name ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_spec",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Part Name ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_part_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Weight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PCR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_pcr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Revision ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "revision",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "sust_filename",
											"type": "String"
										},
										"sink": {
											"name": "sustainability_file_name",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ABLB_LZ_LT",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename_sust",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_sust",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Update_Records_In_Run_Log",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_Sustainability_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_Zone_Sustainability_to_Landing_Table').output.rowsCopied ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_Zone_Sustainability_to_Landing_Table').output.rowsRead , ' where  job_key = ' ,activity('LKP_Job_Key_Sustainability').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SP_landing_to_Staging_Sustainability",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LKP_Update_Records_In_Run_Log",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_sustainability]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename_sust",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Execute_Staging_to_Curated_Pipeline_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_Sustainability_Staging_Table_to_Curated_ADLS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename_sust",
									"type": "Expression"
								},
								"action_insert": {
									"value": "@pipeline().parameters.action_insert",
									"type": "Expression"
								},
								"exec_status": {
									"value": "@pipeline().parameters.exec_status",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.file_size",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@pipeline().parameters.job_file_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_landing_to_Staging_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_Sustainability",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename_sust",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_Sustainability_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "ETL"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/Sustainability"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_sust": {
						"type": "string",
						"defaultValue": "lnd_sustainability"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"file_size": {
						"type": "string"
					},
					"filename_sust": {
						"type": "string"
					},
					"job_file_key": {
						"type": "string"
					},
					"job_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_Sustainability_LZ_LT"
					},
					"job_name_Sustainability": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T11:04:52Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Sustainability_Raw_Directory_to_DB_Updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_Sustainability_Job_Name",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "job_name_Sustainability",
							"value": {
								"value": "@variables('job_name_Sustainability_value')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LKP_Job_Key_Sustainability",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "PF_Sustainability_Job_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Sustainability_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_Sustainability",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_Zone_Sustainability_to_Landing_Table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "sust_filename",
										"value": {
											"value": "@pipeline().parameters.filename_sust",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Level ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "level",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": " RelationshipName ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "relation_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " From or To ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "from_or_to",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Type ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Name ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_spec",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Part Name ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_part_name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Weight ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_weight",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " UOM ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_uom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " PCR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "material_pcr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": " Revision ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "revision",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "sust_filename",
											"type": "String"
										},
										"sink": {
											"name": "sustainability_file_name",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ABLB_LZ_LT",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_raw",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename_sust",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SQL_Lnd",
								"type": "DatasetReference",
								"parameters": {
									"schema": {
										"value": "@pipeline().parameters.schema_lnd",
										"type": "Expression"
									},
									"table": {
										"value": "@pipeline().parameters.table_sust",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "SP_landing_to_Staging_Sustainability",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_Sustainability_to_Landing_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[usp_lnd_to_rnd_sustainability]",
							"storedProcedureParameters": {
								"file_name": {
									"value": {
										"value": "@pipeline().parameters.filename_sust",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"job_run_key": {
									"value": {
										"value": "@activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key",
										"type": "Expression"
									},
									"type": "Int64"
								},
								"message": {
									"value": null,
									"type": "String"
								},
								"status": {
									"value": null,
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Execute_Staging_to_Curated_Pipeline_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Tran_Sustainability_Staging_Table_to_Curated_ADLS_Updated",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_run_key": {
									"value": "@activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename_sust",
									"type": "Expression"
								},
								"action_insert": {
									"value": "@pipeline().parameters.action_insert",
									"type": "Expression"
								},
								"exec_status": {
									"value": "@pipeline().parameters.exec_status",
									"type": "Expression"
								},
								"file_size": {
									"value": "@pipeline().parameters.file_size",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@pipeline().parameters.job_file_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Job_Run_Status_Pass",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_landing_to_Staging_Sustainability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Job_File_Log_Sustainability",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_Pass",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_landing",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename_sust",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_Sustainability').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.job_file_key",
											"type": "Expression"
										}
									},
									"datafactory_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"pipeline_trigger_time": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"pipeline_trigger_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().TriggerId",
											"type": "Expression"
										}
									},
									"pipeline_run_id": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"pipeline_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_Zone_Sustainability_to_Landing_Table",
								"dependencyConditions": [
									"Failed"
								]
							},
							{
								"activity": "Execute_Staging_to_Curated_Pipeline_copy1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_Sustainability').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"schema": {
						"type": "string",
						"defaultValue": "control_etl"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"directory_raw": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"directory_landing": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/Sustainability"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"schema_lnd": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"table_sust": {
						"type": "string",
						"defaultValue": "lnd_sustainability"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"file_size": {
						"type": "string"
					},
					"filename_sust": {
						"type": "string"
					},
					"job_file_key": {
						"type": "string"
					},
					"job_key": {
						"type": "string"
					}
				},
				"variables": {
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "Extract_and_Load_Sustainability_LZ_LT"
					},
					"job_name_Sustainability": {
						"type": "String"
					},
					"job_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_run_key": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T14:21:58Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_DATA_SAP_Hub_to_Log_Tables')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LKP_Job_Key_SAP",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_SAP_value'),'''')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "LKP_Job_Run_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LKP_Job_Key_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
								"storedProcedureParameters": {
									"ADF_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().DataFactory",
											"type": "Expression"
										}
									},
									"file_transfer_flag": {
										"type": "String",
										"value": {
											"value": "@variables('file_transfer_flag')",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_start_date_time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"last_update_date": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"Pipeline_Name": {
										"type": "String",
										"value": {
											"value": "@pipeline().Pipeline",
											"type": "Expression"
										}
									},
									"Pipeline_Start_Time": {
										"type": "DateTime",
										"value": {
											"value": "@pipeline().TriggerTime",
											"type": "Expression"
										}
									},
									"PL_Run_ID": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Action": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.action_insert",
											"type": "Expression"
										}
									},
									"Execution_Status": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.exec_status",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_from_Hub_toLanding_SAP",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_Run_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SapTableSource",
								"rfcTableOptions": "",
								"customRfcReadTableFunctionModule": "",
								"rfcTableFields": "",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": {
										"value": "@pipeline().parameters.file_extension",
										"type": "Expression"
									}
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "CUSTOMER",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "MATERIAL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "DIVISION",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "DIVISION",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String",
											"physicalType": "N"
										},
										"sink": {
											"name": "CALMONTH",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PROFIT_CTR",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "PROFIT_CTR",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EANUPC",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "EANUPC",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CO_AREA",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "CO_AREA",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/ZBROKER",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/ZBROKER",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CUST_HIE01",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "CUST_HIE01",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CUST_HIE02",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "CUST_HIE02",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CUST_HIE03",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "CUST_HIE03",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/ZSLS_REGN",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/ZSLS_REGN",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CUST_GRP5",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "CUST_GRP5",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "DISTR_CHAN",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RECORDMODE",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "RECORDMODE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/ZSLS_DEPT",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/ZSLS_DEPT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/ZSECTOR",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/ZSECTOR",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "SALESORG",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODH2",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "PRODH2",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODH1",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "PRODH1",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODH3",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "PRODH3",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODH4",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "PRODH4",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODH5",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "PRODH5",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NAME2",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "NAME2",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NAME3",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "NAME3",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NAME40",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "NAME40",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TXTSH",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "TXTSH",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME4",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME4",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TXTMD",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "TXTMD",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME5",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME5",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME6",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME6",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME7",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME7",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME8",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME8",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME9",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME9",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME10",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME10",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME11",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME11",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME12",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME12",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME13",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME13",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME14",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME14",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME15",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME15",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME16",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME16",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME17",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME17",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/NAME18",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "/BIC/NAME18",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CALYEAR",
											"type": "String",
											"physicalType": "N"
										},
										"sink": {
											"name": "CALYEAR",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CALMONTH2",
											"type": "String",
											"physicalType": "N"
										},
										"sink": {
											"name": "CALMONTH2",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "FISCYEAR",
											"type": "String",
											"physicalType": "N"
										},
										"sink": {
											"name": "FISCYEAR",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "FISCVARNT",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "FISCVARNT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "FISCPER3",
											"type": "String",
											"physicalType": "N"
										},
										"sink": {
											"name": "FISCPER3",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QUANT_B",
											"type": "Decimal",
											"physicalType": "P"
										},
										"sink": {
											"name": "QUANT_B",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "BASE_UOM",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "/BIC/ZDOS_QTY",
											"type": "Decimal",
											"physicalType": "P"
										},
										"sink": {
											"name": "/BIC/ZDOS_QTY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BASE_UOM2",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "BASE_UOM2",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NET_VAL_S",
											"type": "Decimal",
											"physicalType": "P"
										},
										"sink": {
											"name": "NET_VAL_S",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "STAT_CURR",
											"type": "String",
											"physicalType": "C"
										},
										"sink": {
											"name": "STAT_CURR",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SAPDataTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ADLS_PLM_EBOM_copy2",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_Landing_SAP",
										"type": "Expression"
									},
									"filename": {
										"value": "@pipeline().parameters.filename_hub",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Job_File_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy_data_from_Hub_toLanding_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_Landing_SAP",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename_hub",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": null
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Copy_data_Landing_to_Raw_SAP",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": {
										"value": "@pipeline().parameters.file_extension",
										"type": "Expression"
									}
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ADLS_PLM_EBOM_copy2",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_Landing_SAP",
										"type": "Expression"
									},
									"filename": {
										"value": "@pipeline().parameters.filename_hub",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ADLS_PLM_EBOM_copy1",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_adls_sap",
										"type": "Expression"
									},
									"delimiter": {
										"value": "@pipeline().parameters.delimiter",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "LKP_Job_File_Log_SAP_RAW_to_Landing",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete_From_Landing",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
								"storedProcedureParameters": {
									"file_location": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.directory_adls_SAP",
											"type": "Expression"
										}
									},
									"file_name": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.filename_hub",
											"type": "Expression"
										}
									},
									"file_size": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.file_size",
											"type": "Expression"
										}
									},
									"job_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
											"type": "Expression"
										}
									},
									"job_run_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
											"type": "Expression"
										}
									},
									"job_file_key": {
										"type": "String",
										"value": {
											"value": "@activity('LKP_Job_File_Log_SAP').output.firstRow.job_file_key",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SP_Job_Run_Status_SAP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LKP_Job_File_Log_SAP_RAW_to_Landing",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
							"storedProcedureParameters": {
								"Action": {
									"value": {
										"value": "@pipeline().parameters.action_update",
										"type": "Expression"
									},
									"type": "String"
								},
								"ADF_Name": {
									"value": {
										"value": "@pipeline().DataFactory",
										"type": "Expression"
									},
									"type": "String"
								},
								"Execution_Status": {
									"value": {
										"value": "@pipeline().parameters.run_status_pass",
										"type": "Expression"
									},
									"type": "String"
								},
								"file_transfer_flag": {
									"value": {
										"value": "@variables('file_transfer_flag')",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_key": {
									"value": {
										"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
										"type": "Expression"
									},
									"type": "String"
								},
								"job_start_date_time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"last_update_date": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Start_Time": {
									"value": {
										"value": "@pipeline().TriggerTime",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"PL_Run_ID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_AzureSQDb_Admin",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LKP_Update_Records_In_Run_Log_SAP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SP_Job_Run_Status_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_to_Raw_SAP').output.dataWritten ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_to_Raw_SAP').output.dataRead , ' where  job_key = ' , activity('LKP_Job_Key_SAP').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_LND_STG_ADMIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Execute_PL_data_LZ_LT_SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LKP_Update_Records_In_Run_Log_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Data_SAP_Hub_Raw_Zone_to_Landing_Table",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"file_size": {
									"value": "@pipeline().parameters.file_size",
									"type": "Expression"
								},
								"filename": {
									"value": "@pipeline().parameters.filename_hub",
									"type": "Expression"
								},
								"job_file_key": {
									"value": "@activity('LKP_Job_File_Log_SAP_RAW_to_Landing').output.firstRow.job_file_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Execute_Fail_Alert_SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_to_Raw_SAP",
								"dependencyConditions": [
									"Failed"
								]
							},
							{
								"activity": "Copy_data_from_Hub_toLanding_SAP",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Fail_Alert",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"job_key": {
									"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Delete_From_Landing",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Copy_data_Landing_to_Raw_SAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ABLB_Sustainability",
								"type": "DatasetReference",
								"parameters": {
									"container": {
										"value": "@pipeline().parameters.filesystem_adls",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.directory_Landing_SAP",
										"type": "Expression"
									},
									"file": {
										"value": "@pipeline().parameters.filename_hub",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"parameters": {
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"schema": {
						"type": "string",
						"defaultValue": "etl"
					},
					"file_size": {
						"type": "string"
					},
					"directory_ftp": {
						"type": "string",
						"defaultValue": "SAP Data"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".CSV"
					},
					"schema_ftp": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"directory_adls_sap": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"directory_Landing_SAP": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "in Progress"
					},
					"filename_hub": {
						"type": "string",
						"defaultValue": "SAP_Open_Hub.CSV"
					},
					"delimiter": {
						"type": "string",
						"defaultValue": ","
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_FTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T11:04:52Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_SAP_Hub_Raw_Zone_to_Landing_Table')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_DATA_to_ETL_Log_Tables')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,4)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(or(equals(variables('filename_trim_value'),'EBOM'),equals(variables('filename_trim_value'),'Sust')), equals(variables('filename_trim_value'),'SAPB'))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Send_Email",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@pipeline().parameters.email_url_fielname_incorrect",
											"type": "Expression"
										},
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {},
										"body": {
											"value": "{\n  \"title\":\"Incorrect File Name\",\n  \"filename\":\"@{pipeline().parameters.file_name}\",\n  \"Message\":\"Please check the filename\" \n}",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Switch_File_Type_copy1",
									"type": "Switch",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@variables('filename_trim_value')",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "EBOM",
												"activities": [
													{
														"name": "PF_EBOM_Job_Name_copy1",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_EBOM_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_EBOM_Job_Name_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_EBOM_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@variables('job_key')",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.run_status_pass",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Copy_data_SFTP_to_Landing",
														"type": "Copy",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "DelimitedTextSource",
																"storeSettings": {
																	"type": "SftpReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false
																},
																"formatSettings": {
																	"type": "DelimitedTextReadSettings"
																}
															},
															"sink": {
																"type": "DelimitedTextSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "DelimitedTextWriteSettings",
																	"quoteAllText": true,
																	"fileExtension": {
																		"value": "@pipeline().parameters.file_extension",
																		"type": "Expression"
																	}
																}
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_SFTP_EBOM",
																"type": "DatasetReference",
																"parameters": {
																	"directory": {
																		"value": "@pipeline().parameters.directory_sftp",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@string(pipeline().parameters.file_name)",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_ADLS_PLM_EBOM",
																"type": "DatasetReference",
																"parameters": {
																	"filesystem": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_Landing_EBOM",
																		"type": "Expression"
																	}
																}
															}
														]
													},
													{
														"name": "LKP_Job_File_Log_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Copy_data_SFTP_to_Landing",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
																"storedProcedureParameters": {
																	"file_location": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.directory_Landing_EBOM",
																			"type": "Expression"
																		}
																	},
																	"file_name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_name",
																			"type": "Expression"
																		}
																	},
																	"file_size": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_size",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_run_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Copy_data_EBOM_Landing_to_Raw",
														"type": "Copy",
														"dependsOn": [
															{
																"activity": "LKP_Job_File_Log_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "DelimitedTextSource",
																"storeSettings": {
																	"type": "AzureBlobStorageReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false
																},
																"formatSettings": {
																	"type": "DelimitedTextReadSettings"
																}
															},
															"sink": {
																"type": "DelimitedTextSink",
																"storeSettings": {
																	"type": "AzureBlobStorageWriteSettings"
																},
																"formatSettings": {
																	"type": "DelimitedTextWriteSettings",
																	"quoteAllText": true,
																	"fileExtension": {
																		"value": "@pipeline().parameters.file_extension",
																		"type": "Expression"
																	}
																}
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_ABLB_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_Landing_EBOM",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_ABLB_Landing_EBOM",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_adls",
																		"type": "Expression"
																	}
																}
															}
														]
													},
													{
														"name": "LKP_Job_File_Log_RAW_to_Landing",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Delete_EBOM_From_Landing",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
																"storedProcedureParameters": {
																	"file_location": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.directory_adls",
																			"type": "Expression"
																		}
																	},
																	"file_name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_name",
																			"type": "Expression"
																		}
																	},
																	"file_size": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_size",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_run_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "SP_Job_Run_Status",
														"type": "SqlServerStoredProcedure",
														"dependsOn": [
															{
																"activity": "LKP_Update_Records_In_Run_Log",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
															"storedProcedureParameters": {
																"Action": {
																	"value": {
																		"value": "@pipeline().parameters.action_update",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"ADF_Name": {
																	"value": {
																		"value": "@pipeline().DataFactory",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"Execution_Status": {
																	"value": {
																		"value": "@pipeline().parameters.run_status_pass",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"file_transfer_flag": {
																	"value": {
																		"value": "@variables('file_transfer_flag')",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"job_key": {
																	"value": {
																		"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"job_start_date_time": {
																	"value": {
																		"value": "@pipeline().TriggerTime",
																		"type": "Expression"
																	},
																	"type": "DateTime"
																},
																"last_update_date": {
																	"value": {
																		"value": "@pipeline().TriggerTime",
																		"type": "Expression"
																	},
																	"type": "DateTime"
																},
																"Pipeline_Name": {
																	"value": {
																		"value": "@pipeline().Pipeline",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"Pipeline_Start_Time": {
																	"value": {
																		"value": "@pipeline().TriggerTime",
																		"type": "Expression"
																	},
																	"type": "DateTime"
																},
																"PL_Run_ID": {
																	"value": {
																		"value": "@pipeline().RunId",
																		"type": "Expression"
																	},
																	"type": "String"
																}
															}
														},
														"linkedServiceName": {
															"referenceName": "LS_AzureSQDb_Admin",
															"type": "LinkedServiceReference"
														}
													},
													{
														"name": "LKP_Update_Records_In_Run_Log",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_File_Log_RAW_to_Landing",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_EBOM_Landing_to_Raw').output.dataWritten ,  ',' ,  ' records_read = ' , activity('Copy_data_EBOM_Landing_to_Raw').output.dataRead , ' where  job_key = ' ,activity('LKP_Job_Key_copy1').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute_fail_alert",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Copy_data_SFTP_to_Landing",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Copy_data_EBOM_Landing_to_Raw",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Delete_EBOM_From_Landing",
														"type": "Delete",
														"dependsOn": [
															{
																"activity": "Copy_data_EBOM_Landing_to_Raw",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"dataset": {
																"referenceName": "DS_ABLB_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_Landing_EBOM",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	}
																}
															},
															"enableLogging": false,
															"storeSettings": {
																"type": "AzureBlobStorageReadSettings",
																"recursive": true,
																"enablePartitionDiscovery": false
															}
														}
													}
												]
											},
											{
												"value": "Sust",
												"activities": [
													{
														"name": "Copy_data_SFTP_to_Landing_Sust",
														"type": "Copy",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "DelimitedTextSource",
																"storeSettings": {
																	"type": "SftpReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false
																},
																"formatSettings": {
																	"type": "DelimitedTextReadSettings"
																}
															},
															"sink": {
																"type": "DelimitedTextSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "DelimitedTextWriteSettings",
																	"quoteAllText": true,
																	"fileExtension": {
																		"value": "@pipeline().parameters.file_extension",
																		"type": "Expression"
																	}
																}
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_SFTP_EBOM",
																"type": "DatasetReference",
																"parameters": {
																	"directory": {
																		"value": "@pipeline().parameters.directory_sftp",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@string(pipeline().parameters.file_name)",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_ADLS_PLM_EBOM",
																"type": "DatasetReference",
																"parameters": {
																	"filesystem": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_Landing_Sustainability",
																		"type": "Expression"
																	}
																}
															}
														]
													},
													{
														"name": "LKP_Job_File_Log_Sust_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Copy_data_SFTP_to_Landing_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
																"storedProcedureParameters": {
																	"file_location": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.directory_Landing_Sustainability",
																			"type": "Expression"
																		}
																	},
																	"file_name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_name",
																			"type": "Expression"
																		}
																	},
																	"file_size": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_size",
																			"type": "Expression"
																		}
																	},
																	"job_file_key": {
																		"type": "Int64",
																		"value": null
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_run_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Run_Log_Sust').output.firstRow.job_run_key",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Copy_data_Landing_to_Raw_Sust",
														"type": "Copy",
														"dependsOn": [
															{
																"activity": "LKP_Job_File_Log_Sust_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "DelimitedTextSource",
																"storeSettings": {
																	"type": "AzureBlobStorageReadSettings",
																	"recursive": true,
																	"enablePartitionDiscovery": false
																},
																"formatSettings": {
																	"type": "DelimitedTextReadSettings"
																}
															},
															"sink": {
																"type": "DelimitedTextSink",
																"storeSettings": {
																	"type": "AzureBlobStorageWriteSettings"
																},
																"formatSettings": {
																	"type": "DelimitedTextWriteSettings",
																	"quoteAllText": true,
																	"fileExtension": ".txt"
																}
															},
															"enableStaging": false,
															"translator": {
																"type": "TabularTranslator",
																"typeConversion": true,
																"typeConversionSettings": {
																	"allowDataTruncation": true,
																	"treatBooleanAsNumber": false
																}
															}
														},
														"inputs": [
															{
																"referenceName": "DS_ABLB_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_Landing_Sustainability",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DS_ABLB_Landing_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_adls_sust",
																		"type": "Expression"
																	}
																}
															}
														]
													},
													{
														"name": "LKP_Job_File_Log_Sust_RAW_to_Landing",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Delete_From_Landing",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
																"storedProcedureParameters": {
																	"file_location": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.directory_adls_sust",
																			"type": "Expression"
																		}
																	},
																	"file_name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_name",
																			"type": "Expression"
																		}
																	},
																	"file_size": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.file_size",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_run_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Run_Log_Sust').output.firstRow.job_run_key",
																			"type": "Expression"
																		}
																	},
																	"job_file_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_File_Log_Sust_copy1').output.firstRow.job_file_key",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "SP_Job_Run_Status_Sustainability",
														"type": "SqlServerStoredProcedure",
														"dependsOn": [
															{
																"activity": "LKP_Update_Records_In_Run_Log_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
															"storedProcedureParameters": {
																"Action": {
																	"value": {
																		"value": "@pipeline().parameters.action_update",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"ADF_Name": {
																	"value": {
																		"value": "@pipeline().DataFactory",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"Execution_Status": {
																	"value": {
																		"value": "@pipeline().parameters.run_status_pass",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"file_transfer_flag": {
																	"value": {
																		"value": "@variables('file_transfer_flag')",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"job_key": {
																	"value": {
																		"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"job_start_date_time": {
																	"value": {
																		"value": "@pipeline().TriggerTime",
																		"type": "Expression"
																	},
																	"type": "DateTime"
																},
																"last_update_date": {
																	"value": {
																		"value": "@pipeline().TriggerTime",
																		"type": "Expression"
																	},
																	"type": "DateTime"
																},
																"Pipeline_Name": {
																	"value": {
																		"value": "@pipeline().Pipeline",
																		"type": "Expression"
																	},
																	"type": "String"
																},
																"Pipeline_Start_Time": {
																	"value": {
																		"value": "@pipeline().TriggerTime",
																		"type": "Expression"
																	},
																	"type": "DateTime"
																},
																"PL_Run_ID": {
																	"value": {
																		"value": "@pipeline().RunId",
																		"type": "Expression"
																	},
																	"type": "String"
																}
															}
														},
														"linkedServiceName": {
															"referenceName": "LS_AzureSQDb_Admin",
															"type": "LinkedServiceReference"
														}
													},
													{
														"name": "LKP_Update_Records_In_Run_Log_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_File_Log_Sust_RAW_to_Landing",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_to_Raw_Sust').output.dataWritten ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_to_Raw_Sust').output.dataRead , ' where  job_key = ''' ,activity('LKP_Job_Key_Sust').output.firstRow.job_key ,''' and job_run_key = ''' , activity('LKP_Job_Run_Log_Sust').output.firstRow.job_run_key,'''; Select 0 as DummyValue;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "PF_Sustainability_Job_Name",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_Sustainability_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Sust",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Sustainability_Job_Name",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Sustainability_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Sust",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.run_status_pass",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute_Fail_Alert_Sust",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Copy_data_SFTP_to_Landing_Sust",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Copy_data_Landing_to_Raw_Sust",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute_PL_Data_LZ_to_LT",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "SP_Job_Run_Status_Sustainability",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Data_Sustainability_Raw_Directory_to_DB",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"filename_sust": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('LKP_Job_File_Log_Sust_copy1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Delete_From_Landing",
														"type": "Delete",
														"dependsOn": [
															{
																"activity": "Copy_data_Landing_to_Raw_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"dataset": {
																"referenceName": "DS_ABLB_Sustainability",
																"type": "DatasetReference",
																"parameters": {
																	"container": {
																		"value": "@pipeline().parameters.filesystem_adls",
																		"type": "Expression"
																	},
																	"directory": {
																		"value": "@pipeline().parameters.directory_Landing_Sustainability",
																		"type": "Expression"
																	},
																	"file": {
																		"value": "@pipeline().parameters.file_name",
																		"type": "Expression"
																	}
																}
															},
															"enableLogging": false,
															"storeSettings": {
																"type": "AzureBlobStorageReadSettings",
																"recursive": true,
																"enablePartitionDiscovery": false
															}
														}
													}
												]
											}
										]
									}
								}
							]
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting/"
					},
					"directory_adls": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"schema": {
						"type": "string",
						"defaultValue": "etl"
					},
					"directory_adls_sust": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"file_size": {
						"type": "string"
					},
					"directory_adls_sap": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"directory_Landing_EBOM": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/EBOM"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"directory_Landing_Sustainability": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/Sustainability"
					},
					"directory_Landing_SAP": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"email_url_fielname_incorrect": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"job_key": {
						"type": "string"
					},
					"job_run_key": {
						"type": "string"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".csv"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"directory": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_EBOM_value": {
						"type": "String",
						"defaultValue": "PickFile_EBOM_SFTP_ADLS"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "PickFile_Sustainability_SFTP_ADLS"
					},
					"directory_sust": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_SFTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T11:04:52Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_Sustainability_Raw_Directory_to_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Adhoc_Files_FTP_to_ADLS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Files_Details",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_FTP_Excel_Files",
								"type": "DatasetReference",
								"parameters": {
									"directory": {
										"value": "@pipeline().globalParameters.directory_ftp_adhoc",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "FtpReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false,
								"useBinaryTransfer": true
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get_Files_Details",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get_Files_Details').output.childitems",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Set variable1",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "v_file_name",
										"value": {
											"value": "@item().name",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Execute Pipeline1",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Set variable1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Data_Adhoc_Files_ADLS_to_DB_copy1",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"file_name": {
												"value": "@variables('v_file_name')",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"parameters": {
					"directory_ftp": {
						"type": "string",
						"defaultValue": "Sustainability Reporting Manual Update Files"
					}
				},
				"variables": {
					"v_file_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-17T13:37:33Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_Adhoc_Files_ADLS_to_DB_copy1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_Adhoc_Files_FTP_to_ADLS_updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Files_Details",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_FTP_Excel_Files",
								"type": "DatasetReference",
								"parameters": {
									"directory": {
										"value": "@pipeline().globalParameters.directory_ftp_adhoc",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "FtpReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false,
								"useBinaryTransfer": true
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get_Files_Details",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get_Files_Details').output.childitems",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Set variable1",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "v_file_name",
										"value": {
											"value": "@item().name",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Execute Adhoc Files to DB",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Set variable1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Data_Adhoc_Files_ADLS_to_DB_updated",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"file_name": {
												"value": "@variables('v_file_name')",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Execute_Fail_Alert_ADLS",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Execute Adhoc Files to DB",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_email",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								}
							]
						}
					}
				],
				"parameters": {
					"directory_ftp": {
						"type": "string",
						"defaultValue": "Sustainability Reporting Manual Update Files"
					}
				},
				"variables": {
					"v_file_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-21T07:38:39Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_Adhoc_Files_ADLS_to_DB_updated')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_PLM_Files_Landing_to_Raw_Directory')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,4)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(or(equals(variables('filename_trim_value'),'EBOM'),equals(variables('filename_trim_value'),'Sust')), equals(variables('filename_trim_value'),'SAPB'))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Send_Email",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@pipeline().parameters.email_url_fielname_incorrect",
											"type": "Expression"
										},
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {},
										"body": {
											"value": "{\n  \"title\":\"Incorrect File Name\",\n  \"filename\":\"@{pipeline().parameters.file_name}\",\n  \"Message\":\"Please check the filename\" \n}",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Switch_File_Type_copy1",
									"type": "Switch",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@variables('filename_trim_value')",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "EBOM",
												"activities": [
													{
														"name": "PF_EBOM_Job_Name_copy1",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_EBOM_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_EBOM_Job_Name_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_EBOM_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@variables('job_key')",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.run_status_pass",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Pipeline2",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Reuse_SFTP_PLM",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"container": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_raw": {
																	"value": "@pipeline().parameters.directory_adls",
																	"type": "Expression"
																},
																"file": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"action_update": {
																	"value": "@pipeline().parameters.action_update",
																	"type": "Expression"
																},
																"exec_status": {
																	"value": "@pipeline().parameters.run_status_pass",
																	"type": "Expression"
																},
																"file_transfer_flag": {
																	"value": "@variables('file_transfer_flag')",
																	"type": "Expression"
																},
																"file_location_raw": {
																	"value": "@pipeline().parameters.directory_adls",
																	"type": "Expression"
																},
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"directory_sftp": {
																	"value": "@pipeline().globalParameters.directory_sftp",
																	"type": "Expression"
																},
																"file_location_landing": {
																	"value": "@pipeline().parameters.directory_Landing_EBOM",
																	"type": "Expression"
																},
																"directory_landing": {
																	"value": "@pipeline().parameters.directory_Landing_EBOM",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup2",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Pipeline2",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Pipeline3",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup2",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Data_EBOM_Raw_Directory_to_DB",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename_ebom": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"filesize_ebom": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('Lookup2').output.firstRow.job_file_key",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "Sust",
												"activities": [
													{
														"name": "PF_Sustainability_Job_Name",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_Sustainability_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Sust",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Sustainability_Job_Name",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Sustainability_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Sust",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.run_status_pass",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute_PL_Data_LZ_to_LT",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Data_Sustainability_Raw_Directory_to_DB",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"filename_sust": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('Lookup1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Pipeline1",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Reuse_SFTP_PLM",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"container": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_raw": {
																	"value": "@pipeline().parameters.directory_adls_sust",
																	"type": "Expression"
																},
																"file": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Sust').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"action_update": {
																	"value": "@pipeline().parameters.action_update",
																	"type": "Expression"
																},
																"exec_status": {
																	"value": "@pipeline().parameters.run_status_pass",
																	"type": "Expression"
																},
																"file_transfer_flag": {
																	"value": "@variables('file_transfer_flag')",
																	"type": "Expression"
																},
																"file_location_raw": {
																	"value": "@pipeline().parameters.directory_adls_sust",
																	"type": "Expression"
																},
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"directory_sftp": {
																	"value": "@pipeline().parameters.directory_sftp",
																	"type": "Expression"
																},
																"file_location_landing": {
																	"value": "@pipeline().parameters.directory_Landing_Sustainability",
																	"type": "Expression"
																},
																"directory_landing": {
																	"value": "@pipeline().parameters.directory_Landing_Sustainability",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Pipeline1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													}
												]
											}
										]
									}
								}
							]
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting/"
					},
					"directory_adls": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"schema": {
						"type": "string",
						"defaultValue": "etl"
					},
					"directory_adls_sust": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"file_size": {
						"type": "string"
					},
					"directory_adls_sap": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"directory_Landing_EBOM": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/EBOM"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"directory_Landing_Sustainability": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/Sustainability"
					},
					"directory_Landing_SAP": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"email_url_fielname_incorrect": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"job_key": {
						"type": "string"
					},
					"job_run_key": {
						"type": "string"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".csv"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"directory": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_EBOM_value": {
						"type": "String",
						"defaultValue": "PickFile_EBOM_SFTP_ADLS"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "PickFile_Sustainability_SFTP_ADLS"
					},
					"directory_sust": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_SFTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-16T06:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_EBOM_Raw_Directory_to_DB')]",
				"[concat(variables('factoryId'), '/pipelines/PL_Data_Sustainability_Raw_Directory_to_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_PLM_Files_Landing_to_Raw_Directory_Updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,4)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(or(equals(variables('filename_trim_value'),'EBOM'),equals(variables('filename_trim_value'),'Sust')), equals(variables('filename_trim_value'),'SAPB'))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Send_Email",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@pipeline().parameters.email_url_fielname_incorrect",
											"type": "Expression"
										},
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {},
										"body": {
											"value": "{\n  \"title\":\"Incorrect File Name\",\n  \"filename\":\"@{pipeline().parameters.file_name}\",\n  \"Message\":\"Please check the filename\" \n}",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Switch_File_Type_copy1",
									"type": "Switch",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@variables('filename_trim_value')",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "EBOM",
												"activities": [
													{
														"name": "PF_EBOM_Job_Name_copy1",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_EBOM_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_EBOM_Job_Name_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_EBOM_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_copy1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@variables('job_key')",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.run_status_pass",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Pipeline2",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_copy1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Reuse_SFTP_PLM_updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"container": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_raw": {
																	"value": "@pipeline().parameters.directory_adls",
																	"type": "Expression"
																},
																"file": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"action_update": {
																	"value": "@pipeline().parameters.action_update",
																	"type": "Expression"
																},
																"exec_status": {
																	"value": "@pipeline().parameters.run_status_pass",
																	"type": "Expression"
																},
																"file_transfer_flag": {
																	"value": "@variables('file_transfer_flag')",
																	"type": "Expression"
																},
																"file_location_raw": {
																	"value": "@pipeline().parameters.directory_adls",
																	"type": "Expression"
																},
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"directory_sftp": {
																	"value": "@pipeline().globalParameters.directory_sftp",
																	"type": "Expression"
																},
																"file_location_landing": {
																	"value": "@pipeline().parameters.directory_Landing_EBOM",
																	"type": "Expression"
																},
																"directory_landing": {
																	"value": "@pipeline().parameters.directory_Landing_EBOM",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup2",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Pipeline2",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute Pipeline3",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup2",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Data_EBOM_Raw_Directory_to_DB_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"filename_ebom": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"filesize_ebom": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_copy1').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('Lookup2').output.firstRow.job_file_key",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute_Fail_Alert_EBOM",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Pipeline2",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute Pipeline3",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_copy1').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@variables('job_name')",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "Sust",
												"activities": [
													{
														"name": "PF_Sustainability_Job_Name",
														"type": "SetVariable",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"variableName": "job_name",
															"value": {
																"value": "@variables('job_name_Sustainability_value')",
																"type": "Expression"
															}
														}
													},
													{
														"name": "LKP_Job_Key_Sust",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "PF_Sustainability_Job_Name",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_Sustainability_value'),'''')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "LKP_Job_Run_Log_Sust",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "LKP_Job_Key_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
																"storedProcedureParameters": {
																	"Action": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.action_insert",
																			"type": "Expression"
																		}
																	},
																	"ADF_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().DataFactory",
																			"type": "Expression"
																		}
																	},
																	"Execution_Status": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().parameters.run_status_pass",
																			"type": "Expression"
																		}
																	},
																	"file_transfer_flag": {
																		"type": "String",
																		"value": {
																			"value": "@variables('file_transfer_flag')",
																			"type": "Expression"
																		}
																	},
																	"job_key": {
																		"type": "String",
																		"value": {
																			"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																			"type": "Expression"
																		}
																	},
																	"job_start_date_time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"last_update_date": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Name": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().Pipeline",
																			"type": "Expression"
																		}
																	},
																	"Pipeline_Start_Time": {
																		"type": "DateTime",
																		"value": {
																			"value": "@pipeline().TriggerTime",
																			"type": "Expression"
																		}
																	},
																	"PL_Run_ID": {
																		"type": "String",
																		"value": {
																			"value": "@pipeline().RunId",
																			"type": "Expression"
																		}
																	}
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute_PL_Data_LZ_to_LT",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Lookup1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Data_Sustainability_Raw_Directory_to_DB_Updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"filename_sust": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"job_file_key": {
																	"value": "@activity('Lookup1').output.firstRow.job_file_key",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Execute Pipeline1",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "LKP_Job_Run_Log_Sust",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Reuse_SFTP_PLM_updated",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"container": {
																	"value": "@pipeline().parameters.filesystem_adls",
																	"type": "Expression"
																},
																"directory_raw": {
																	"value": "@pipeline().parameters.directory_adls_sust",
																	"type": "Expression"
																},
																"file": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"schema": {
																	"value": "@pipeline().parameters.schema",
																	"type": "Expression"
																},
																"table": {
																	"value": "@pipeline().parameters.table_job_run_log",
																	"type": "Expression"
																},
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_run_key": {
																	"value": "@activity('LKP_Job_Run_Log_Sust').output.firstRow.job_run_key",
																	"type": "Expression"
																},
																"action_update": {
																	"value": "@pipeline().parameters.action_update",
																	"type": "Expression"
																},
																"exec_status": {
																	"value": "@pipeline().parameters.run_status_pass",
																	"type": "Expression"
																},
																"file_transfer_flag": {
																	"value": "@variables('file_transfer_flag')",
																	"type": "Expression"
																},
																"file_location_raw": {
																	"value": "@pipeline().parameters.directory_adls_sust",
																	"type": "Expression"
																},
																"file_name": {
																	"value": "@pipeline().parameters.file_name",
																	"type": "Expression"
																},
																"file_size": {
																	"value": "@pipeline().parameters.file_size",
																	"type": "Expression"
																},
																"directory_sftp": {
																	"value": "@pipeline().parameters.directory_sftp",
																	"type": "Expression"
																},
																"file_location_landing": {
																	"value": "@pipeline().parameters.directory_Landing_Sustainability",
																	"type": "Expression"
																},
																"directory_landing": {
																	"value": "@pipeline().parameters.directory_Landing_Sustainability",
																	"type": "Expression"
																}
															}
														}
													},
													{
														"name": "Lookup1",
														"type": "Lookup",
														"dependsOn": [
															{
																"activity": "Execute Pipeline1",
																"dependencyConditions": [
																	"Succeeded"
																]
															}
														],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "AzureSqlSource",
																"sqlReaderQuery": {
																	"value": "@concat('select max(job_file_key) as job_file_key from ', pipeline().parameters.schema,'.',pipeline().parameters.table_job_file_log, ' where file_name = ''' , pipeline().parameters.file_name,''' ;')",
																	"type": "Expression"
																},
																"queryTimeout": "02:00:00",
																"partitionOption": "None"
															},
															"dataset": {
																"referenceName": "DS_LND_STG_ADMIN",
																"type": "DatasetReference",
																"parameters": {}
															}
														}
													},
													{
														"name": "Execute_Fail_Alert_Sust",
														"type": "ExecutePipeline",
														"dependsOn": [
															{
																"activity": "Execute Pipeline1",
																"dependencyConditions": [
																	"Failed"
																]
															},
															{
																"activity": "Execute_PL_Data_LZ_to_LT",
																"dependencyConditions": [
																	"Failed"
																]
															}
														],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "PL_Fail_Alert",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"job_key": {
																	"value": "@activity('LKP_Job_Key_Sust').output.firstRow.job_key",
																	"type": "Expression"
																},
																"job_name": {
																	"value": "@variables('job_name')",
																	"type": "Expression"
																}
															}
														}
													}
												]
											}
										]
									}
								}
							]
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting/"
					},
					"directory_adls": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"schema": {
						"type": "string",
						"defaultValue": "control_etl"
					},
					"directory_adls_sust": {
						"type": "string",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"file_size": {
						"type": "string"
					},
					"directory_adls_sap": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"directory_Landing_EBOM": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/EBOM"
					},
					"all_csv_files": {
						"type": "string",
						"defaultValue": "*.csv"
					},
					"directory_Landing_Sustainability": {
						"type": "string",
						"defaultValue": "Landing/RnD/PLM/Sustainability"
					},
					"directory_Landing_SAP": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "In_Progress"
					},
					"email_url_fielname_incorrect": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"job_key": {
						"type": "string"
					},
					"job_run_key": {
						"type": "string"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".csv"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"directory": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/EBOM"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"job_name_EBOM_value": {
						"type": "String",
						"defaultValue": "PickFile_EBOM_SFTP_ADLS"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"job_name_Sustainability_value": {
						"type": "String",
						"defaultValue": "PickFile_Sustainability_SFTP_ADLS"
					},
					"directory_sust": {
						"type": "String",
						"defaultValue": "Raw/RnD/PLM/Sustainability"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_SFTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T14:09:45Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_EBOM_Raw_Directory_to_DB_Updated')]",
				"[concat(variables('factoryId'), '/pipelines/PL_Data_Sustainability_Raw_Directory_to_DB_Updated')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_SAP_File_FTP_Landing_to_Raw_Directory')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,9)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('filename_trim_value'),'ZBW_Sales')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "LKP_Job_Key_SAP",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_SAP_value'),'''')",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "LKP_Job_Run_Log_SAP",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "LKP_Job_Key_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
											"storedProcedureParameters": {
												"ADF_Name": {
													"type": "String",
													"value": {
														"value": "@pipeline().DataFactory",
														"type": "Expression"
													}
												},
												"file_transfer_flag": {
													"type": "String",
													"value": {
														"value": "@variables('file_transfer_flag')",
														"type": "Expression"
													}
												},
												"job_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
														"type": "Expression"
													}
												},
												"job_start_date_time": {
													"type": "DateTime",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"last_update_date": {
													"type": "DateTime",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"Pipeline_Name": {
													"type": "String",
													"value": {
														"value": "@pipeline().Pipeline",
														"type": "Expression"
													}
												},
												"Pipeline_Start_Time": {
													"type": "DateTime",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"PL_Run_ID": {
													"type": "String",
													"value": {
														"value": "@pipeline().RunId",
														"type": "Expression"
													}
												},
												"Action": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.action_insert",
														"type": "Expression"
													}
												},
												"Execution_Status": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.exec_status",
														"type": "Expression"
													}
												}
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Copy_data_from_FTP_toLanding_SAP",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "LKP_Job_Run_Log_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FtpReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false,
												"useBinaryTransfer": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": {
													"value": "@pipeline().parameters.file_extension",
													"type": "Expression"
												}
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_FTP_SAP",
											"type": "DatasetReference",
											"parameters": {
												"directory": {
													"value": "@pipeline().globalParameters.directory_ftp_sap",
													"type": "Expression"
												},
												"file": {
													"value": "@pipeline().parameters.file_name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_ADLS_PLM_EBOM_copy1",
											"type": "DatasetReference",
											"parameters": {
												"filesystem": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_Landing_SAP",
													"type": "Expression"
												},
												"delimiter": {
													"value": "@pipeline().parameters.delimiter",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "LKP_Job_File_Log_SAP",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Copy_data_from_FTP_toLanding_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
											"storedProcedureParameters": {
												"file_location": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.directory_Landing_SAP",
														"type": "Expression"
													}
												},
												"file_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_name",
														"type": "Expression"
													}
												},
												"file_size": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_size",
														"type": "Expression"
													}
												},
												"job_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
														"type": "Expression"
													}
												},
												"job_run_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
														"type": "Expression"
													}
												},
												"job_file_key": {
													"type": "String",
													"value": null
												}
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Copy_data_Landing_to_Raw_SAP",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "LKP_Job_File_Log_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": {
													"value": "@pipeline().parameters.file_extension",
													"type": "Expression"
												}
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_ADLS_PLM_SAP",
											"type": "DatasetReference",
											"parameters": {
												"filesystem": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_Landing_SAP",
													"type": "Expression"
												},
												"file": {
													"value": "@pipeline().parameters.file_name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_ADLS_PLM_EBOM_copy1",
											"type": "DatasetReference",
											"parameters": {
												"filesystem": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_adls_sap",
													"type": "Expression"
												},
												"delimiter": {
													"value": "@pipeline().parameters.delimiter",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "LKP_Job_File_Log_SAP_RAW_to_Landing",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Delete_From_Landing",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
											"storedProcedureParameters": {
												"file_location": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.directory_adls_SAP",
														"type": "Expression"
													}
												},
												"file_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_name",
														"type": "Expression"
													}
												},
												"file_size": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_size",
														"type": "Expression"
													}
												},
												"job_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
														"type": "Expression"
													}
												},
												"job_run_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
														"type": "Expression"
													}
												},
												"job_file_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_File_Log_SAP').output.firstRow.job_file_key",
														"type": "Expression"
													}
												}
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "SP_Job_Run_Status_SAP",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "LKP_Job_File_Log_SAP_RAW_to_Landing",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
										"storedProcedureParameters": {
											"Action": {
												"value": {
													"value": "@pipeline().parameters.action_update",
													"type": "Expression"
												},
												"type": "String"
											},
											"ADF_Name": {
												"value": {
													"value": "@pipeline().DataFactory",
													"type": "Expression"
												},
												"type": "String"
											},
											"Execution_Status": {
												"value": {
													"value": "@pipeline().parameters.run_status_pass",
													"type": "Expression"
												},
												"type": "String"
											},
											"file_transfer_flag": {
												"value": {
													"value": "@variables('file_transfer_flag')",
													"type": "Expression"
												},
												"type": "String"
											},
											"job_key": {
												"value": {
													"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
													"type": "Expression"
												},
												"type": "String"
											},
											"job_start_date_time": {
												"value": {
													"value": "@pipeline().TriggerTime",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"last_update_date": {
												"value": {
													"value": "@pipeline().TriggerTime",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Start_Time": {
												"value": {
													"value": "@pipeline().TriggerTime",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"PL_Run_ID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "LS_AzureSQDb_Admin",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LKP_Update_Records_In_Run_Log_SAP",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SP_Job_Run_Status_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "@concat('Update ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_run_log, ' set records_copied = ' , activity('Copy_data_Landing_to_Raw_SAP').output.dataWritten ,  ',' ,  ' records_read = ' , activity('Copy_data_Landing_to_Raw_SAP').output.dataRead , ' where  job_key = ' , activity('LKP_Job_Key_SAP').output.firstRow.job_key, ' and job_run_key =' , activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key, ';select 0 as DummyValue;')",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Execute_PL_data_LZ_LT_SAP",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "LKP_Update_Records_In_Run_Log_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Data_SAP_File_Raw_Directory_to_DB",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"file_size": {
												"value": "@pipeline().parameters.file_size",
												"type": "Expression"
											},
											"filename": {
												"value": "@pipeline().parameters.file_name",
												"type": "Expression"
											},
											"job_file_key": {
												"value": "@activity('LKP_Job_File_Log_SAP_RAW_to_Landing').output.firstRow.job_file_key",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Execute_Fail_Alert_SAP",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Copy_data_Landing_to_Raw_SAP",
											"dependencyConditions": [
												"Failed"
											]
										},
										{
											"activity": "Copy_data_from_FTP_toLanding_SAP",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Fail_Alert",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"job_key": {
												"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Delete_From_Landing",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy_data_Landing_to_Raw_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "DS_ABLB_Sustainability",
											"type": "DatasetReference",
											"parameters": {
												"container": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_Landing_SAP",
													"type": "Expression"
												},
												"file": {
													"value": "@pipeline().parameters.file_name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobStorageReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file_log"
					},
					"schema": {
						"type": "string",
						"defaultValue": "etl"
					},
					"file_size": {
						"type": "string"
					},
					"directory_ftp": {
						"type": "string",
						"defaultValue": "SAP Data"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".CSV"
					},
					"schema_ftp": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"directory_adls_sap": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"directory_Landing_SAP": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "in Progress"
					},
					"delimiter": {
						"type": "string",
						"defaultValue": ";"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_FTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T15:01:30Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_SAP_File_Raw_Directory_to_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_SAP_File_FTP_Landing_to_Raw_Directory_Updated')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "filename_trim_value",
							"value": {
								"value": "@substring(pipeline().parameters.file_name,0,9)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('filename_trim_value'),'ZBW_Sales')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "LKP_Job_Key_SAP",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "@concat('select job_key from ' ,pipeline().parameters.schema,'.',pipeline().parameters.table_job_control,' where job_name=''',variables('job_name_SAP_value'),'''')",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "LKP_Job_Run_Log_SAP",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "LKP_Job_Key_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderStoredProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
											"storedProcedureParameters": {
												"ADF_Name": {
													"type": "String",
													"value": {
														"value": "@pipeline().DataFactory",
														"type": "Expression"
													}
												},
												"file_transfer_flag": {
													"type": "String",
													"value": {
														"value": "@variables('file_transfer_flag')",
														"type": "Expression"
													}
												},
												"job_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
														"type": "Expression"
													}
												},
												"job_start_date_time": {
													"type": "DateTime",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"last_update_date": {
													"type": "DateTime",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"Pipeline_Name": {
													"type": "String",
													"value": {
														"value": "@pipeline().Pipeline",
														"type": "Expression"
													}
												},
												"Pipeline_Start_Time": {
													"type": "DateTime",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"PL_Run_ID": {
													"type": "String",
													"value": {
														"value": "@pipeline().RunId",
														"type": "Expression"
													}
												},
												"Action": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.action_insert",
														"type": "Expression"
													}
												},
												"Execution_Status": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.exec_status",
														"type": "Expression"
													}
												}
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Copy_data_from_FTP_toLanding_SAP",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "LKP_Job_Run_Log_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FtpReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false,
												"useBinaryTransfer": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": {
													"value": "@pipeline().parameters.file_extension",
													"type": "Expression"
												}
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_FTP_SAP",
											"type": "DatasetReference",
											"parameters": {
												"directory": {
													"value": "@pipeline().globalParameters.directory_ftp_sap",
													"type": "Expression"
												},
												"file": {
													"value": "@pipeline().parameters.file_name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_ADLS_PLM_EBOM_copy1",
											"type": "DatasetReference",
											"parameters": {
												"filesystem": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_Landing_SAP",
													"type": "Expression"
												},
												"delimiter": {
													"value": "@pipeline().parameters.delimiter",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "LKP_Job_File_Log_SAP",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Copy_data_from_FTP_toLanding_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
											"storedProcedureParameters": {
												"file_location": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.directory_Landing_SAP",
														"type": "Expression"
													}
												},
												"file_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_name",
														"type": "Expression"
													}
												},
												"file_size": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_size",
														"type": "Expression"
													}
												},
												"job_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
														"type": "Expression"
													}
												},
												"job_run_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
														"type": "Expression"
													}
												},
												"job_file_key": {
													"type": "String",
													"value": null
												},
												"datafactory_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().DataFactory",
														"type": "Expression"
													}
												},
												"pipeline_trigger_time": {
													"type": "String",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"pipeline_trigger_id": {
													"type": "String",
													"value": {
														"value": "@pipeline().TriggerId",
														"type": "Expression"
													}
												},
												"pipeline_run_id": {
													"type": "String",
													"value": {
														"value": "@pipeline().RunId",
														"type": "Expression"
													}
												},
												"pipeline_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().Pipeline",
														"type": "Expression"
													}
												}
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Copy_data_Landing_to_Raw_SAP",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "LKP_Job_File_Log_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": {
													"value": "@pipeline().parameters.file_extension",
													"type": "Expression"
												}
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_ADLS_PLM_SAP",
											"type": "DatasetReference",
											"parameters": {
												"filesystem": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_Landing_SAP",
													"type": "Expression"
												},
												"file": {
													"value": "@pipeline().parameters.file_name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_ADLS_PLM_EBOM_copy1",
											"type": "DatasetReference",
											"parameters": {
												"filesystem": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_adls_sap",
													"type": "Expression"
												},
												"delimiter": {
													"value": "@pipeline().parameters.delimiter",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "LKP_Job_File_Log_SAP_RAW_to_Landing",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Delete_From_Landing",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderStoredProcedureName": "[[Rnd].[USP_Job_File_Log]",
											"storedProcedureParameters": {
												"file_location": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.directory_adls_SAP",
														"type": "Expression"
													}
												},
												"file_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_name",
														"type": "Expression"
													}
												},
												"file_size": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.file_size",
														"type": "Expression"
													}
												},
												"job_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
														"type": "Expression"
													}
												},
												"job_run_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_Run_Log_SAP').output.firstRow.job_run_key",
														"type": "Expression"
													}
												},
												"job_file_key": {
													"type": "String",
													"value": {
														"value": "@activity('LKP_Job_File_Log_SAP').output.firstRow.job_file_key",
														"type": "Expression"
													}
												},
												"datafactory_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().DataFactory",
														"type": "Expression"
													}
												},
												"pipeline_trigger_time": {
													"type": "String",
													"value": {
														"value": "@pipeline().TriggerTime",
														"type": "Expression"
													}
												},
												"pipeline_trigger_id": {
													"type": "String",
													"value": {
														"value": "@pipeline().TriggerId",
														"type": "Expression"
													}
												},
												"pipeline_run_id": {
													"type": "String",
													"value": {
														"value": "@pipeline().RunId",
														"type": "Expression"
													}
												},
												"pipeline_name": {
													"type": "String",
													"value": {
														"value": "@pipeline().Pipeline",
														"type": "Expression"
													}
												}
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "DS_LND_STG_ADMIN",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "SP_Job_Run_Status_SAP",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "LKP_Job_File_Log_SAP_RAW_to_Landing",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Rnd].[USP_Insert_Job_Run]",
										"storedProcedureParameters": {
											"Action": {
												"value": {
													"value": "@pipeline().parameters.action_update",
													"type": "Expression"
												},
												"type": "String"
											},
											"ADF_Name": {
												"value": {
													"value": "@pipeline().DataFactory",
													"type": "Expression"
												},
												"type": "String"
											},
											"Execution_Status": {
												"value": {
													"value": "@pipeline().parameters.run_status_pass",
													"type": "Expression"
												},
												"type": "String"
											},
											"file_transfer_flag": {
												"value": {
													"value": "@variables('file_transfer_flag')",
													"type": "Expression"
												},
												"type": "String"
											},
											"job_key": {
												"value": {
													"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
													"type": "Expression"
												},
												"type": "String"
											},
											"job_start_date_time": {
												"value": {
													"value": "@pipeline().TriggerTime",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"last_update_date": {
												"value": {
													"value": "@pipeline().TriggerTime",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Start_Time": {
												"value": {
													"value": "@pipeline().TriggerTime",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"PL_Run_ID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "LS_AzureSQDb_Admin",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Execute_PL_data_LZ_LT_SAP",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SP_Job_Run_Status_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Data_SAP_File_Raw_Directory_to_DB_Updated",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"file_size": {
												"value": "@pipeline().parameters.file_size",
												"type": "Expression"
											},
											"filename": {
												"value": "@pipeline().parameters.file_name",
												"type": "Expression"
											},
											"job_file_key": {
												"value": "@activity('LKP_Job_File_Log_SAP_RAW_to_Landing').output.firstRow.job_file_key",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Execute_Fail_Alert_SAP",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Copy_data_Landing_to_Raw_SAP",
											"dependencyConditions": [
												"Failed"
											]
										},
										{
											"activity": "Copy_data_from_FTP_toLanding_SAP",
											"dependencyConditions": [
												"Failed"
											]
										},
										{
											"activity": "Execute_PL_data_LZ_LT_SAP",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Fail_Alert",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"job_key": {
												"value": "@activity('LKP_Job_Key_SAP').output.firstRow.job_key",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Delete_From_Landing",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy_data_Landing_to_Raw_SAP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "DS_ABLB_Sustainability",
											"type": "DatasetReference",
											"parameters": {
												"container": {
													"value": "@pipeline().parameters.filesystem_adls",
													"type": "Expression"
												},
												"directory": {
													"value": "@pipeline().parameters.directory_Landing_SAP",
													"type": "Expression"
												},
												"file": {
													"value": "@pipeline().parameters.file_name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobStorageReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"parameters": {
					"file_name": {
						"type": "string"
					},
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting"
					},
					"filesystem_adls": {
						"type": "string",
						"defaultValue": "clx-datalake"
					},
					"table_job_control": {
						"type": "string",
						"defaultValue": "job_control"
					},
					"table_job_run_log": {
						"type": "string",
						"defaultValue": "job_run_log"
					},
					"table_job_file_log": {
						"type": "string",
						"defaultValue": "job_file"
					},
					"schema": {
						"type": "string",
						"defaultValue": "control_etl"
					},
					"file_size": {
						"type": "string"
					},
					"directory_ftp": {
						"type": "string",
						"defaultValue": "SAP Data"
					},
					"file_extension": {
						"type": "string",
						"defaultValue": ".CSV"
					},
					"schema_ftp": {
						"type": "string",
						"defaultValue": "tmp"
					},
					"email_url": {
						"type": "string",
						"defaultValue": "https://prod-51.eastus2.logic.azure.com:443/workflows/ceda425476814f708eb7cc9d5367112a/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VK3vUyZ1Fxy6PdExFQAekhkbehfXiU6f9tEztB4qy-c"
					},
					"directory_adls_sap": {
						"type": "string",
						"defaultValue": "Raw/RnD/SAP"
					},
					"directory_Landing_SAP": {
						"type": "string",
						"defaultValue": "Landing/RnD/SAP"
					},
					"action_insert": {
						"type": "string",
						"defaultValue": "insert"
					},
					"action_update": {
						"type": "string",
						"defaultValue": "update"
					},
					"run_status_pass": {
						"type": "string",
						"defaultValue": "Success"
					},
					"run_status_fail": {
						"type": "string",
						"defaultValue": "Failed"
					},
					"exec_status": {
						"type": "string",
						"defaultValue": "in Progress"
					},
					"delimiter": {
						"type": "string",
						"defaultValue": ";"
					}
				},
				"variables": {
					"container": {
						"type": "String",
						"defaultValue": "clx-datalake"
					},
					"job_key": {
						"type": "String"
					},
					"job_run_key": {
						"type": "String"
					},
					"job_file_key": {
						"type": "String"
					},
					"file_transfer_flag": {
						"type": "String",
						"defaultValue": "Y"
					},
					"filename_trim_value": {
						"type": "String"
					},
					"df_name": {
						"type": "String"
					},
					"job_name_SAP_value": {
						"type": "String",
						"defaultValue": "PickFile_SAP_FTP_ADLS"
					},
					"directory_sap": {
						"type": "String",
						"defaultValue": "Raw/RnD/SAP"
					},
					"job_name": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-18T15:01:33Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_SAP_File_Raw_Directory_to_DB_Updated')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Data_PLM_Files_SFTP_to_ADLS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_File_Details_from_SFTP",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_SFTP_Files",
								"type": "DatasetReference",
								"parameters": {
									"directory": {
										"value": "@pipeline().globalParameters.directory_sftp",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems",
								"itemName",
								"itemType",
								"lastModified"
							],
							"storeSettings": {
								"type": "SftpReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "ForEach_File",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get_File_Details_from_SFTP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get_File_Details_from_SFTP').output.childitems",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Execute_PL_Data_to_Log_Tables",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Set variable1_copy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Data_PLM_Files_Landing_to_Raw_Directory",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"file_name": {
												"value": "@variables('v_file_names_copy')",
												"type": "Expression"
											},
											"file_size": {
												"value": "@activity('Get_Metadata_FIle_Size').output.size",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Set variable1_copy",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Get_Metadata_FIle_Size",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "v_file_names_copy",
										"value": {
											"value": "@item().name",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Get_Metadata_FIle_Size",
									"type": "GetMetadata",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "DS_SFTP_Files_copy1",
											"type": "DatasetReference",
											"parameters": {
												"directory": {
													"value": "@pipeline().parameters.directory_sftp",
													"type": "Expression"
												},
												"file": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										},
										"fieldList": [
											"size"
										],
										"storeSettings": {
											"type": "SftpReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										},
										"formatSettings": {
											"type": "DelimitedTextReadSettings"
										}
									}
								}
							]
						}
					}
				],
				"parameters": {
					"directory_sftp": {
						"type": "string",
						"defaultValue": "/home/svcrndreporting/"
					}
				},
				"variables": {
					"v_file_names_copy": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PL_ClOROX_SR"
				},
				"annotations": [],
				"lastPublishTime": "2021-06-16T06:23:06Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Data_PLM_Files_Landing_to_Raw_Directory')]"
			]
		}
	]
}